(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{HnTE:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminSessionsPageModule",(function(){return D}));var i=n("ofXK"),s=n("3Pt+"),o=n("tyNb"),c=n("1kSV"),a=n("aSpy"),b=n("RPsU"),r=n("pjmv"),l=n.n(r),d=n("nYR2"),g=n("JUCI"),h=n("fXoL"),m=n("A3DQ"),u=n("Uqoa"),f=n("MbNv"),p=n("Lcal"),S=n("zAMY");function v(t,e){if(1&t&&(h.Wb(0,"option",32),h.Qc(1),h.Vb()),2&t){const t=e.$implicit;h.sc("value",t),h.Cb(1),h.Rc(t)}}function V(t,e){if(1&t){const t=h.Xb();h.Wb(0,"div",9),h.Wb(1,"div",10),h.Wb(2,"div",11),h.Wb(3,"div",12),h.Wb(4,"div",11),h.Wb(5,"div",13),h.Wb(6,"label",14),h.Qc(7,"From"),h.Vb(),h.Vb(),h.Vb(),h.Wb(8,"div",11),h.Wb(9,"div",13),h.Wb(10,"form"),h.Wb(11,"div",15),h.Wb(12,"div",16),h.Wb(13,"input",17,18),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc().startDate=e})),h.Vb(),h.Wb(15,"div",19),h.Wb(16,"button",20),h.ic("click",(function(){return h.Fc(t),h.Cc(14).toggle()})),h.Rb(17,"i",21),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(18,"div",13),h.Wb(19,"ngb-timepicker",22),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc().startTime=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(20,"div",23),h.Wb(21,"div",11),h.Wb(22,"div",13),h.Wb(23,"label",14),h.Qc(24,"To"),h.Vb(),h.Vb(),h.Vb(),h.Wb(25,"div",11),h.Wb(26,"div",13),h.Wb(27,"form"),h.Wb(28,"div",15),h.Wb(29,"div",16),h.Wb(30,"input",24,25),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc().endDate=e})),h.Vb(),h.Wb(32,"div",19),h.Wb(33,"button",20),h.ic("click",(function(){return h.Fc(t),h.Cc(31).toggle()})),h.Rb(34,"i",21),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(35,"div",13),h.Wb(36,"ngb-timepicker",22),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc().endTime=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(37,"div",26),h.Wb(38,"div",11),h.Wb(39,"div",27),h.Wb(40,"label",28),h.Qc(41,"Time Zone"),h.Vb(),h.Vb(),h.Vb(),h.Wb(42,"div",11),h.Wb(43,"div",13),h.Wb(44,"select",29),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc().filterTimezone=e})),h.Oc(45,v,2,2,"option",30),h.Vb(),h.Vb(),h.Wb(46,"div",13),h.Wb(47,"button",31),h.ic("click",(function(){return h.Fc(t),h.kc().getFeedbackSessions()})),h.Qc(48," Filter by Range "),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb()}if(2&t){const t=h.kc();h.Cb(13),h.sc("ngModel",t.startDate),h.Cb(6),h.sc("ngModel",t.startTime)("spinners",!1),h.Cb(11),h.sc("ngModel",t.endDate),h.Cb(6),h.sc("ngModel",t.endTime)("spinners",!1),h.Cb(8),h.sc("ngModel",t.filterTimezone),h.Cb(1),h.sc("ngForOf",t.timezones)}}function W(t,e){1&t&&(h.Wb(0,"div",33),h.Qc(1," Currently No Ongoing Sessions "),h.Vb())}function k(t,e){if(1&t&&(h.Wb(0,"option",32),h.Qc(1),h.Vb()),2&t){const t=e.$implicit;h.sc("value",t),h.Cb(1),h.Rc(t)}}function C(t,e){if(1&t&&(h.Wb(0,"span"),h.Qc(1),h.Vb()),2&t){const t=h.kc().$implicit;h.Cb(1),h.Rc(t.responseRate)}}function O(t,e){if(1&t){const t=h.Xb();h.Wb(0,"span"),h.Wb(1,"a",51),h.ic("click",(function(e){h.Fc(t);const n=h.kc().$implicit,i=h.kc(2).$implicit;return h.kc(3).getResponseRate(i.key,n.ongoingSession.courseId,n.ongoingSession.feedbackSessionName,e)})),h.Qc(2,"Show"),h.Vb(),h.Vb()}}function T(t,e){if(1&t&&(h.Wb(0,"tr"),h.Wb(1,"td"),h.Qc(2),h.Vb(),h.Wb(3,"td"),h.Wb(4,"strong"),h.Qc(5),h.Vb(),h.Qc(6),h.Vb(),h.Wb(7,"td"),h.Oc(8,C,2,1,"span",49),h.Oc(9,O,3,0,"span",49),h.Vb(),h.Wb(10,"td"),h.Qc(11),h.Vb(),h.Wb(12,"td"),h.Qc(13),h.Vb(),h.Wb(14,"td"),h.Wb(15,"a",50),h.Qc(16),h.Vb(),h.Vb(),h.Vb()),2&t){const t=e.$implicit;h.Cb(2),h.Rc(t.ongoingSession.sessionStatus),h.Cb(3),h.Sc("[",t.ongoingSession.courseId,"]"),h.Cb(1),h.Sc(" ",t.ongoingSession.feedbackSessionName,""),h.Cb(2),h.sc("ngIf",t.responseRate),h.Cb(1),h.sc("ngIf",!t.responseRate),h.Cb(2),h.Rc(t.startTimeString),h.Cb(2),h.Rc(t.endTimeString),h.Cb(2),h.sc("href",t.ongoingSession.instructorHomePageLink,h.Ic),h.Cb(1),h.Rc(t.ongoingSession.creatorEmail)}}function y(t,e){if(1&t&&(h.Wb(0,"div",45),h.Wb(1,"div",46),h.Wb(2,"table",47),h.Wb(3,"thead"),h.Wb(4,"tr"),h.Wb(5,"th"),h.Qc(6,"Status"),h.Vb(),h.Wb(7,"th"),h.Qc(8,"[Course ID] Session Name"),h.Vb(),h.Wb(9,"th"),h.Qc(10,"Response Rate"),h.Vb(),h.Wb(11,"th"),h.Qc(12,"Start Time"),h.Vb(),h.Wb(13,"th"),h.Qc(14,"End Time"),h.Vb(),h.Wb(15,"th"),h.Qc(16,"Creator"),h.Vb(),h.Vb(),h.Vb(),h.Wb(17,"tbody"),h.Oc(18,T,17,9,"tr",48),h.Vb(),h.Vb(),h.Vb(),h.Vb()),2&t){const t=h.kc().$implicit;h.sc("@collapseAnim",void 0),h.Cb(18),h.sc("ngForOf",t.value)}}function M(t,e){if(1&t){const t=h.Xb();h.Wb(0,"div",40),h.Wb(1,"div",41),h.ic("click",(function(){h.Fc(t);const n=e.$implicit,i=h.kc(3);return i.institutionPanelsStatus[n.key]=!i.institutionPanelsStatus[n.key]})),h.Wb(2,"strong"),h.Qc(3),h.Vb(),h.Wb(4,"div",42),h.Rb(5,"tm-panel-chevron",43),h.Vb(),h.Vb(),h.Oc(6,y,19,2,"div",44),h.Vb()}if(2&t){const t=e.$implicit,n=h.kc(3);h.Cb(3),h.Tc("",t.key," - Number of sessions: ",t.value.length,""),h.Cb(2),h.sc("isExpanded",n.institutionPanelsStatus[t.key]),h.Cb(1),h.sc("ngIf",n.institutionPanelsStatus[t.key])}}function w(t,e){if(1&t){const t=h.Xb();h.Wb(0,"div"),h.Wb(1,"div",35),h.Wb(2,"div",36),h.Qc(3," Display session start/end time in this time zone: "),h.Vb(),h.Wb(4,"div",37),h.Wb(5,"select",38),h.ic("ngModelChange",(function(e){return h.Fc(t),h.kc(2).tableTimezone=e}))("ngModelChange",(function(){return h.Fc(t),h.kc(2).updateDisplayedTimes()})),h.Oc(6,k,2,2,"option",30),h.Vb(),h.Vb(),h.Vb(),h.Oc(7,M,7,4,"div",39),h.lc(8,"keyvalue"),h.Vb()}if(2&t){const t=h.kc(2);h.Cb(5),h.sc("ngModel",t.tableTimezone),h.Cb(1),h.sc("ngForOf",t.timezones),h.Cb(1),h.sc("ngForOf",h.mc(8,3,t.sessions))}}function F(t,e){if(1&t&&(h.Wb(0,"div"),h.Oc(1,w,9,5,"div",34),h.Vb()),2&t){const t=h.kc(),e=h.Cc(20);h.Cb(1),h.sc("ngIf",t.totalOngoingSessions)("ngIfElse",e)}}const I=[{path:"",component:(()=>{class t{constructor(t,e,n){this.timezoneService=t,this.statusMessageService=e,this.feedbackSessionsService=n,this.totalOngoingSessions=0,this.totalOpenSessions=0,this.totalClosedSessions=0,this.totalAwaitingSessions=0,this.totalInstitutes=0,this.sessions={},this.institutionPanelsStatus={},this.showFilter=!1,this.timezones=[],this.filterTimezone="",this.tableTimezone="",this.startDate={},this.startTime={},this.endDate={},this.endTime={},this.timezoneString="",this.startTimeString="",this.endTimeString="",this.isLoadingOngoingSessions=!1}ngOnInit(){this.timezones=Object.keys(this.timezoneService.getTzOffsets()),this.filterTimezone=this.timezoneService.guessTimezone(),this.tableTimezone=this.timezoneService.guessTimezone();const t=l()();this.startDate={year:t.year(),month:t.month()+1,day:t.date()},this.startTime={hour:t.hour(),minute:t.minute()},this.endTime={hour:t.hour(),minute:t.minute()};const e=l()(t).add(1,"weeks");this.endDate={year:e.year(),month:e.month()+1,day:e.date()},this.getFeedbackSessions()}openAllInstitutions(){for(const t of Object.keys(this.institutionPanelsStatus))this.institutionPanelsStatus[t]=!0}closeAllInstitutions(){for(const t of Object.keys(this.institutionPanelsStatus))this.institutionPanelsStatus[t]=!1}showDateFromMillis(t){return this.timezoneService.formatToString(t,this.tableTimezone,"ddd, DD MMM YYYY, hh:mm a")}getMomentInstant(t,e,n,i,s){const o=this.timezoneService.getMomentInstance(null,this.filterTimezone);return o.set("year",t),o.set("month",e),o.set("date",n),o.set("hour",i),o.set("minute",s),o}getFeedbackSessions(){const t=this.getMomentInstant(this.startDate.year,this.startDate.month-1,this.startDate.day,this.startTime.hour,this.startTime.minute),e=this.getMomentInstant(this.endDate.year,this.endDate.month-1,this.endDate.day,this.endTime.hour,this.endTime.minute);this.startTimeString=t.format("ddd, DD MMM YYYY, hh:mm a"),this.endTimeString=e.format("ddd, DD MMM YYYY, hh:mm a"),this.timezoneString=this.filterTimezone,this.isLoadingOngoingSessions=!0,this.feedbackSessionsService.getOngoingSessions(t.toDate().getTime(),e.toDate().getTime()).pipe(Object(d.a)(()=>this.isLoadingOngoingSessions=!1)).subscribe(t=>{this.totalOngoingSessions=t.totalOngoingSessions,this.totalOpenSessions=t.totalOpenSessions,this.totalClosedSessions=t.totalClosedSessions,this.totalAwaitingSessions=t.totalAwaitingSessions,this.totalInstitutes=t.totalInstitutes,Object.keys(t.sessions).forEach(e=>{this.sessions[e]=t.sessions[e].map(t=>({ongoingSession:t,startTimeString:this.showDateFromMillis(t.startTime),endTimeString:this.showDateFromMillis(t.endTime)}))}),this.institutionPanelsStatus={};for(const e of Object.keys(t.sessions))this.institutionPanelsStatus[e]=!0},t=>{this.statusMessageService.showErrorToast(t.error.message)})}getResponseRate(t,e,n,i){i&&(i.preventDefault(),i.stopPropagation()),this.feedbackSessionsService.loadSessionStatistics(e,n).subscribe(i=>{const s=this.sessions[t].filter(t=>t.ongoingSession.courseId===e&&t.ongoingSession.feedbackSessionName===n);s.length&&(s[0].responseRate=`${i.submittedTotal} / ${i.expectedTotal}`)},t=>{this.statusMessageService.showErrorToast(t.error.message)})}updateDisplayedTimes(){for(const t of Object.values(this.sessions))for(const e of t)e.startTimeString=this.showDateFromMillis(e.ongoingSession.startTime),e.endTimeString=this.showDateFromMillis(e.ongoingSession.endTime)}}return t.\u0275fac=function(e){return new(e||t)(h.Qb(m.b),h.Qb(u.a),h.Qb(f.a))},t.\u0275cmp=h.Kb({type:t,selectors:[["tm-admin-sessions-page"]],decls:22,vars:14,consts:[[1,"fas","fa-arrows-alt-h"],[1,"btn","btn-info","btn-sm","btn-margin-right",3,"click"],[1,"btn","btn-warning","btn-sm",3,"click"],[2,"margin-top","20px"],[1,"text-center"],["id","btn-toggle-filter",1,"btn","btn-link","center-block",3,"click"],["id","filter-section","class","card bg-light",4,"ngIf"],["noOngoingSessions",""],[4,"tmIsLoading"],["id","filter-section",1,"card","bg-light"],[1,"card-body"],[1,"row"],["data-toggle","tooltip","data-placement","top",1,"col-xl-4"],[1,"col-6"],[1,"label-control"],[1,"form-group"],[1,"input-group"],["id","start-date","placeholder","Date","name","dp1","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["dp1","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-light",3,"click"],[1,"fas","fa-calendar-alt"],[3,"ngModel","spinners","ngModelChange"],["data-toggle","tooltip","data-placement","top",1,"col-xl-4","border-left-gray"],["id","end-date","placeholder","Date","name","dp2","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["dp2","ngbDatepicker"],[1,"col-xl-4","border-left-gray"],[1,"col-12"],[1,"control-label"],["id","filter-timezone",1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","btn-get-sessions",1,"btn","btn-primary","btn-block",3,"click"],[3,"value"],["role","alert",1,"alert","alert-warning","margin-top-30px"],[4,"ngIf","ngIfElse"],[1,"row","margin-top-30px",2,"align-items","center"],[1,"col-md-5"],[1,"col-md-7"],["id","table-timezone",1,"form-control",3,"ngModel","ngModelChange"],["class","card bg-light margin-top-30px",4,"ngFor","ngForOf"],[1,"card","bg-light","margin-top-30px"],[1,"text-white","card-header","bg-primary","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],["class","card-body session-table-body",4,"ngIf"],[1,"card-body","session-table-body"],[1,"table-responsive"],["id","ongoing-sessions-table",1,"table","table-striped","data-table","session-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"href"],["href","javascript:;",3,"click"]],template:function(t,e){1&t&&(h.Wb(0,"h4"),h.Wb(1,"small"),h.Qc(2),h.Rb(3,"br"),h.Qc(4),h.Rb(5,"i",0),h.Qc(6),h.Vb(),h.Rb(7,"br"),h.Vb(),h.Wb(8,"button",1),h.ic("click",(function(){return e.openAllInstitutions()})),h.Qc(9,"Open All"),h.Vb(),h.Wb(10,"button",2),h.ic("click",(function(){return e.closeAllInstitutions()})),h.Qc(11,"Collapse All"),h.Vb(),h.Wb(12,"div",3),h.Wb(13,"div",4),h.Wb(14,"button",5),h.ic("click",(function(){return e.showFilter=!e.showFilter})),h.Qc(15),h.Rb(16,"br"),h.Rb(17,"i"),h.Vb(),h.Vb(),h.Oc(18,V,49,8,"div",6),h.Vb(),h.Oc(19,W,2,0,"ng-template",null,7,h.Pc),h.Oc(21,F,2,2,"div",8)),2&t&&(h.Cb(2),h.Vc(" Total: ",e.totalOngoingSessions," - Opened: ",e.totalOpenSessions," - Closed: ",e.totalClosedSessions," - Waiting To Open: ",e.totalAwaitingSessions," - Institutions: ",e.totalInstitutes," "),h.Cb(2),h.Sc(" ",e.startTimeString," \xa0 "),h.Cb(2),h.Tc(" \xa0 ",e.endTimeString," \xa0 ",e.timezoneString," "),h.Cb(9),h.Sc(" ",e.showFilter?"Hide":"Show"," filter "),h.Cb(2),h.Fb("fas fa-chevron-",e.showFilter?"up":"down",""),h.Cb(1),h.sc("ngIf",e.showFilter),h.Cb(3),h.sc("tmIsLoading",e.isLoadingOngoingSessions))},directives:[i.u,p.a,s.F,s.q,s.r,c.l,s.c,s.p,s.s,c.s,s.B,i.t,s.u,s.E,S.a],pipes:[i.m],styles:["@media (min-width:1200px){.border-left-gray[_ngcontent-%COMP%]{border-left:1px solid rgba(0,0,0,.2)}}.margin-top-30px[_ngcontent-%COMP%]{margin-top:30px}.session-table-body[_ngcontent-%COMP%]{padding:0}.session-table[_ngcontent-%COMP%]{margin-bottom:0}"],data:{animation:[g.a]}}),t})()}];let D=(()=>{class t{}return t.\u0275mod=h.Ob({type:t}),t.\u0275inj=h.Nb({factory:function(e){return new(e||t)},imports:[[i.c,s.j,c.f,c.t,o.h.forChild(I),a.a,b.a]]}),t})()},JUCI:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("R0Ic");const s=Object(i.j)("collapseAnim",[Object(i.i)(":leave",[Object(i.h)({height:"*",overflow:"hidden"}),Object(i.e)("300ms ease-in-out",Object(i.h)({height:0,opacity:0}))]),Object(i.i)(":enter",[Object(i.h)({height:"0",overflow:"hidden"}),Object(i.e)("300ms ease-in-out",Object(i.h)({height:"*",opacity:1}))])])},RPsU:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("ofXK"),s=n("fXoL");let o=(()=>{class t{}return t.\u0275mod=s.Ob({type:t}),t.\u0275inj=s.Nb({factory:function(e){return new(e||t)},imports:[[i.c]]}),t})()},zAMY:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("fXoL"),s=n("ofXK");function o(t,e){1&t&&i.Rb(0,"i",3)}function c(t,e){1&t&&i.Rb(0,"i",4)}let a=(()=>{class t{constructor(){this.isExpanded=!1}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Kb({type:t,selectors:[["tm-panel-chevron"]],inputs:{isExpanded:"isExpanded"},decls:3,vars:2,consts:[[1,"chevron"],["class","fas fa-chevron-down",4,"ngIf"],["class","fas fa-chevron-up",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-up"]],template:function(t,e){1&t&&(i.Wb(0,"div",0),i.Oc(1,o,1,0,"i",1),i.Oc(2,c,1,0,"i",2),i.Vb()),2&t&&(i.Cb(1),i.sc("ngIf",!e.isExpanded),i.Cb(1),i.sc("ngIf",e.isExpanded))},directives:[s.u],styles:[".chevron[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}"]}),t})()}}]);