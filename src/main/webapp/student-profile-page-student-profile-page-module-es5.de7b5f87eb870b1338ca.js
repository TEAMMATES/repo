function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{"/Tzu":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(t){return t[t.WARNING=0]="WARNING",t[t.DANGER=1]="DANGER",t[t.INFO=2]="INFO",t[t.NEUTRAL=3]="NEUTRAL",t[t.LOAD=4]="LOAD",t}({})},Babz:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i("fXoL"),n=i("ofXK");function o(t,e){if(1&t){var i=r.Xb();r.Wb(0,"div",2),r.Wb(1,"p",3),r.Qc(2),r.Vb(),r.Wb(3,"button",4),r.ic("click",(function(){return r.Fc(i),r.kc().retryEvent.emit()})),r.Rb(4,"i",5),r.Qc(5,"\xa0Retry"),r.Vb(),r.Vb()}if(2&t){var n=r.kc();r.Cb(2),r.Rc(n.message)}}function a(t,e){1&t&&r.qc(0)}var s=["*"],c=function(){var t=function(){function t(){_classCallCheck(this,t),this.message="",this.shouldShowRetry=!1,this.retryEvent=new r.n}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["tm-loading-retry"]],inputs:{message:"message",shouldShowRetry:"shouldShowRetry"},outputs:{retryEvent:"retryEvent"},ngContentSelectors:s,decls:3,vars:2,consts:[["class","text-center",4,"ngIf","ngIfElse"],["content",""],[1,"text-center"],[1,"text-muted","m-1"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-redo"]],template:function(t,e){if(1&t&&(r.rc(),r.Oc(0,o,6,1,"div",0),r.Oc(1,a,1,0,"ng-template",null,1,r.Pc)),2&t){var i=r.Cc(2);r.sc("ngIf",e.shouldShowRetry)("ngIfElse",i)}},directives:[n.u],styles:[""]}),t}()},UGSt:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("fXoL"),n=function(){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"transform",value:function(t){return Object.keys(t).map((function(e){return t[e]}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=r.Pb({name:"enumToArray",type:t,pure:!0}),t}()},WbH0:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("R8lv"),n=i("fXoL"),o=function(){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"transform",value:function(t){switch(t){case r.h.MALE:return"Male";case r.h.FEMALE:return"Female";case r.h.OTHER:return"Not Specified";default:return"Unknown"}}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=n.Pb({name:"genderFormat",type:t,pure:!0}),t}()},Wsbs:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("fXoL"),n=function(){var t=function(){function t(){_classCallCheck(this,t),this.useBlueSpinner=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["tm-ajax-loading"]],inputs:{useBlueSpinner:"useBlueSpinner"},decls:2,vars:3,consts:[[1,"loading-container"],["role","status"]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Rb(1,"div",1),r.Vb()),2&t&&(r.Cb(1),r.Fb("spinner-border spinner-border-sm text-",e.useBlueSpinner?"primary":"white",""))},styles:[".loading-container[_ngcontent-%COMP%]{display:inline;margin-right:10px}"]}),t}()},a2yK:function(t,e,i){"use strict";i.r(e),i.d(e,"StudentProfilePageModule",(function(){return $}));var r=i("ofXK"),n=i("3Pt+"),o=i("tyNb"),a=i("1kSV"),s=i("fXoL"),c=i("jhN1"),p=["sourceImage"];function l(t,e){if(1&t){var i=s.Xb();s.Wb(0,"div",3),s.Wb(1,"div",4),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"move")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"move")})),s.Qc(2,"\xa0"),s.Vb(),s.Wb(3,"span",5),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","topleft")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","topleft")})),s.Rb(4,"span",6),s.Vb(),s.Wb(5,"span",7),s.Rb(6,"span",6),s.Vb(),s.Wb(7,"span",8),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","topright")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","topright")})),s.Rb(8,"span",6),s.Vb(),s.Wb(9,"span",9),s.Rb(10,"span",6),s.Vb(),s.Wb(11,"span",10),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottomright")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottomright")})),s.Rb(12,"span",6),s.Vb(),s.Wb(13,"span",11),s.Rb(14,"span",6),s.Vb(),s.Wb(15,"span",12),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottomleft")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottomleft")})),s.Rb(16,"span",6),s.Vb(),s.Wb(17,"span",13),s.Rb(18,"span",6),s.Vb(),s.Wb(19,"span",14),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","top")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","top")})),s.Vb(),s.Wb(20,"span",15),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","right")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","right")})),s.Vb(),s.Wb(21,"span",16),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottom")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","bottom")})),s.Vb(),s.Wb(22,"span",17),s.ic("mousedown",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","left")}))("touchstart",(function(t){return s.Fc(i),s.kc().startMove(t,"resize","left")})),s.Vb(),s.Vb()}if(2&t){var r=s.kc();s.Nc("top",r.cropper.y1,"px")("left",r.cropper.x1,"px")("width",r.cropper.x2-r.cropper.x1,"px")("height",r.cropper.y2-r.cropper.y1,"px")("margin-left","center"===r.alignImage?r.marginLeft:null)("visibility",r.imageVisible?"visible":"hidden"),s.Hb("rounded",r.roundCropper)}}function h(t,e){return new Promise((function(i,r){var n=new Image;n.onload=function(){var t=n.width,o=n.height,a=document.createElement("canvas"),s=a.getContext("2d");s?(4<e&&e<9?(a.width=o,a.height=t):(a.width=t,a.height=o),function(t,e,i,r){switch(e){case 2:t.transform(-1,0,0,1,i,0);break;case 3:t.transform(-1,0,0,-1,i,r);break;case 4:t.transform(1,0,0,-1,0,r);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,r,0);break;case 7:t.transform(0,-1,-1,0,r,i);break;case 8:t.transform(0,-1,1,0,0,i)}}(s,e,t,o),s.drawImage(n,0,0),i(a.toDataURL())):r(new Error("No context"))},n.src=t}))}var u,f,d,g,m=((f=function(){function t(e,i,r){_classCallCheck(this,t),this.sanitizer=e,this.cd=i,this.zone=r,this.setImageMaxSizeRetries=0,this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.marginLeft="0px",this.imageVisible=!1,this.format="png",this.outputType="both",this.maintainAspectRatio=!0,this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.containWithinAspectRatio=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage="center",this.startCropImage=new s.n,this.imageCropped=new s.n,this.imageCroppedBase64=new s.n,this.imageCroppedFile=new s.n,this.imageLoaded=new s.n,this.cropperReady=new s.n,this.loadImageFailed=new s.n,this.initCropper()}return _createClass(t,[{key:"ngOnChanges",value:function(t){t.cropper&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.checkCropperPosition(!1),this.doAutoCrop(),this.cd.markForCheck()),t.aspectRatio&&this.imageVisible&&this.resetCropperPosition()}},{key:"initCropper",value:function(){this.imageVisible=!1,this.originalImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.originalSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}},{key:"loadImageFile",value:function(t){var e=this,i=new FileReader;i.onload=function(i){e.isValidImageType(t.type)?e.checkExifAndLoadBase64Image(i.target.result):e.loadImageFailed.emit()},i.readAsDataURL(t)}},{key:"isValidImageType",value:function(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff)/.test(t)}},{key:"checkExifAndLoadBase64Image",value:function(t){var e=this;(function(t){try{var e=function(t){var e=new DataView(function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),i=e.length,r=new Uint8Array(i),n=0;n<i;n++)r[n]=e.charCodeAt(n);return r.buffer}(t));if(65496!=e.getUint16(0,!1))return-2;for(var i=e.byteLength,r=2;r<i;){if(e.getUint16(r+2,!1)<=8)return-1;var n=e.getUint16(r,!1);if(r+=2,65505==n){if(1165519206!=e.getUint32(r+=2,!1))return-1;var o=18761==e.getUint16(r+=6,!1);r+=e.getUint32(r+4,o);var a=e.getUint16(r,o);r+=2;for(var s=0;s<a;s++)if(274==e.getUint16(r+12*s,o))return e.getUint16(r+12*s+8,o)}else{if(65280!=(65280&n))break;r+=e.getUint16(r,!1)}}return-1}(t);return e>1?h(t,e):Promise.resolve(t)}catch(i){return Promise.reject(i)}})(t).then((function(t){return e.fitImageToAspectRatio(t)})).then((function(t){return e.loadBase64Image(t)})).catch((function(){return e.loadImageFailed.emit()}))}},{key:"fitImageToAspectRatio",value:function(t){return this.containWithinAspectRatio?(e=t,i=this.aspectRatio,new Promise((function(t,r){var n=new Image;n.onload=function(){var e=document.createElement("canvas"),o=e.getContext("2d");if(o){var a=n.width/i;e.width=Math.max(n.width,n.height*i),e.height=Math.max(n.height,a),o.drawImage(n,(e.width-n.width)/2,(e.height-n.height)/2),t(e.toDataURL())}else r(new Error("No context"))},n.src=e}))):Promise.resolve(t);var e,i}},{key:"loadBase64Image",value:function(t){var e=this;this.originalBase64=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t),this.originalImage=new Image,this.originalImage.onload=function(){e.originalSize.width=e.originalImage.width,e.originalSize.height=e.originalImage.height,e.cd.markForCheck()},this.originalImage.src=t}},{key:"imageLoadedInView",value:function(){var t=this;null!=this.originalImage&&(this.imageLoaded.emit(),this.setImageMaxSizeRetries=0,setTimeout((function(){return t.checkImageMaxSizeRecursively()})))}},{key:"checkImageMaxSizeRecursively",value:function(){var t=this;this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0?(this.setMaxSize(),this.setCropperScaledMinSize(),this.resetCropperPosition(),this.cropperReady.emit(),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout((function(){t.checkImageMaxSizeRecursively()}),50))}},{key:"onResize",value:function(){this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize()}},{key:"rotateLeft",value:function(){this.transformBase64(8)}},{key:"rotateRight",value:function(){this.transformBase64(6)}},{key:"flipHorizontal",value:function(){this.transformBase64(2)}},{key:"flipVertical",value:function(){this.transformBase64(4)}},{key:"transformBase64",value:function(t){var e=this;this.originalBase64&&h(this.originalBase64,t).then((function(t){return e.fitImageToAspectRatio(t)})).then((function(t){return e.loadBase64Image(t)}))}},{key:"resizeCropperPosition",value:function(){var t=this.sourceImage.nativeElement;this.maxSize.width===t.offsetWidth&&this.maxSize.height===t.offsetHeight||(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}},{key:"resetCropperPosition",value:function(){var t=this.sourceImage.nativeElement;if(this.maintainAspectRatio)if(t.offsetWidth/this.aspectRatio<t.offsetHeight){this.cropper.x1=0,this.cropper.x2=t.offsetWidth;var e=t.offsetWidth/this.aspectRatio;this.cropper.y1=(t.offsetHeight-e)/2,this.cropper.y2=this.cropper.y1+e}else{this.cropper.y1=0,this.cropper.y2=t.offsetHeight;var i=t.offsetHeight*this.aspectRatio;this.cropper.x1=(t.offsetWidth-i)/2,this.cropper.x2=this.cropper.x1+i}else this.cropper.x1=0,this.cropper.x2=t.offsetWidth,this.cropper.y1=0,this.cropper.y2=t.offsetHeight;this.doAutoCrop(),this.imageVisible=!0}},{key:"startMove",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:i,clientX:this.getClientX(t),clientY:this.getClientY(t)},this.cropper)}},{key:"moveImg",value:function(t){this.moveStart.active&&(t.stopPropagation(),t.preventDefault(),"move"===this.moveStart.type?(this.move(t),this.checkCropperPosition(!0)):"resize"===this.moveStart.type&&(this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"setMaxSize",value:function(){if(this.sourceImage){var t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}},{key:"setCropperScaledMinSize",value:function(){this.originalImage?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}},{key:"setCropperScaledMinWidth",value:function(){this.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.originalImage.width*this.maxSize.width):20}},{key:"setCropperScaledMinHeight",value:function(){this.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.originalImage.height*this.maxSize.height):20}},{key:"checkCropperPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}},{key:"moveStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"move",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;this.cropper.x1=this.moveStart.x1+e,this.cropper.y1=this.moveStart.y1+i,this.cropper.x2=this.moveStart.x2+e,this.cropper.y2=this.moveStart.y2+i}},{key:"resize",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;switch(this.moveStart.position){case"left":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth);break;case"topleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"top":this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"topright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"right":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth);break;case"bottomright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottom":this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottomleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight)}this.maintainAspectRatio&&this.checkAspectRatio()}},{key:"checkAspectRatio",value:function(){var t=0,e=0;switch(this.moveStart.position){case"top":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"bottom":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topleft":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topright":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"right":case"bottomright":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"left":case"bottomleft":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio)}}},{key:"doAutoCrop",value:function(){this.autoCrop&&this.crop()}},{key:"crop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.outputType;if(this.sourceImage.nativeElement&&null!=this.originalImage){this.startCropImage.emit();var e=this.getImagePosition(),i=e.x2-e.x1,r=e.y2-e.y1,n=document.createElement("canvas");n.width=i,n.height=r;var o=n.getContext("2d");if(o){null!=this.backgroundColor&&(o.fillStyle=this.backgroundColor,o.fillRect(0,0,i,r)),o.drawImage(this.originalImage,e.x1,e.y1,i,r,0,0,i,r);var a={width:i,height:r,imagePosition:e,cropperPosition:Object.assign({},this.cropper)},s=this.getResizeRatio(i,r);return 1!==s&&(a.width=Math.round(i*s),a.height=this.maintainAspectRatio?Math.round(a.width/this.aspectRatio):Math.round(r*s),function(t,e,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=t.width,o=t.height,a=n/(e=Math.round(e)),s=o/(i=Math.round(i)),c=Math.ceil(a/2),p=Math.ceil(s/2),l=t.getContext("2d");if(l){for(var h=l.getImageData(0,0,n,o),u=l.createImageData(e,i),f=h.data,d=u.data,g=0;g<i;g++)for(var m=0;m<e;m++){var b=4*(m+g*e),v=g*s,y=0,C=0,M=0,x=0,k=0,S=0,w=0,P=Math.floor(m*a),O=Math.floor(g*s),I=Math.ceil((m+1)*a),R=Math.ceil((g+1)*s);I=Math.min(I,n),R=Math.min(R,o);for(var z=O;z<R;z++)for(var W=Math.abs(v-z)/p,_=m*a,V=W*W,A=P;A<I;A++){var T=Math.abs(_-A)/c,F=Math.sqrt(V+T*T);if(!(F>=1)){var L=4*(A+z*n);w+=(y=2*F*F*F-3*F*F+1)*f[L+3],M+=y,f[L+3]<255&&(y=y*f[L+3]/250),x+=y*f[L],k+=y*f[L+1],S+=y*f[L+2],C+=y}}d[b]=x/C,d[b+1]=k/C,d[b+2]=S/C,d[b+3]=w/M}r?(t.width=e,t.height=i):l.clearRect(0,0,n,o),l.putImageData(u,0,0)}}(n,a.width,a.height)),this.cropToOutputType(t,n,a)}}return null}},{key:"getImagePosition",value:function(){var t=this.originalSize.width/this.sourceImage.nativeElement.offsetWidth;return{x1:Math.round(this.cropper.x1*t),y1:Math.round(this.cropper.y1*t),x2:Math.min(Math.round(this.cropper.x2*t),this.originalSize.width),y2:Math.min(Math.round(this.cropper.y2*t),this.originalSize.height)}}},{key:"cropToOutputType",value:function(t,e,i){var r=this;switch(t){case"file":return this.cropToFile(e).then((function(t){return i.file=t,r.imageCropped.emit(i),i}));case"both":return i.base64=this.cropToBase64(e),this.cropToFile(e).then((function(t){return i.file=t,r.imageCropped.emit(i),i}));default:return i.base64=this.cropToBase64(e),this.imageCropped.emit(i),i}}},{key:"cropToBase64",value:function(t){var e=t.toDataURL("image/"+this.format,this.getQuality());return this.imageCroppedBase64.emit(e),e}},{key:"cropToFile",value:function(t){var e=this;return this.getCanvasBlob(t).then((function(t){return t&&e.imageCroppedFile.emit(t),t}))}},{key:"getCanvasBlob",value:function(t){var e=this;return new Promise((function(i){t.toBlob((function(t){return e.zone.run((function(){return i(t)}))}),"image/"+e.format,e.getQuality())}))}},{key:"getQuality",value:function(){return Math.min(1,Math.max(0,this.imageQuality/100))}},{key:"getResizeRatio",value:function(t,e){if(this.resizeToWidth>0){if(!this.onlyScaleDown||t>this.resizeToWidth)return this.resizeToWidth/t}else if(this.resizeToHeight>0&&(!this.onlyScaleDown||e>this.resizeToHeight))return this.resizeToHeight/e;return 1}},{key:"getClientX",value:function(t){return t.touches&&t.touches[0]&&t.touches[0].clientX||t.clientX}},{key:"getClientY",value:function(t){return t.touches&&t.touches[0]&&t.touches[0].clientY||t.clientY}},{key:"imageFileChanged",set:function(t){this.initCropper(),t&&this.loadImageFile(t)}},{key:"imageChangedEvent",set:function(t){this.initCropper(),t&&t.target&&t.target.files&&t.target.files.length>0&&this.loadImageFile(t.target.files[0])}},{key:"imageBase64",set:function(t){this.initCropper(),this.checkExifAndLoadBase64Image(t)}}]),t}()).\u0275fac=function(t){return new(t||f)(s.Qb(c.b),s.Qb(s.h),s.Qb(s.z))},f.\u0275cmp=s.Kb({type:f,selectors:[["image-cropper"]],viewQuery:function(t,e){var i;1&t&&s.Mc(p,!0),2&t&&s.Bc(i=s.jc())&&(e.sourceImage=i.first)},hostVars:2,hostBindings:function(t,e){1&t&&s.ic("resize",(function(){return e.onResize()}),!1,s.Ec)("mousemove",(function(t){return e.moveImg(t)}),!1,s.Dc)("touchmove",(function(t){return e.moveImg(t)}),!1,s.Dc)("mouseup",(function(){return e.moveStop()}),!1,s.Dc)("touchend",(function(){return e.moveStop()}),!1,s.Dc),2&t&&s.Nc("text-align",e.alignImage)},inputs:{format:"format",outputType:"outputType",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",containWithinAspectRatio:"containWithinAspectRatio",cropper:"cropper",alignImage:"alignImage",imageFileChanged:"imageFileChanged",imageChangedEvent:"imageChangedEvent",imageBase64:"imageBase64",backgroundColor:"backgroundColor"},outputs:{startCropImage:"startCropImage",imageCropped:"imageCropped",imageCroppedBase64:"imageCroppedBase64",imageCroppedFile:"imageCroppedFile",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[s.Ab],decls:4,vars:6,consts:[[1,"source-image",3,"src","load"],["sourceImage",""],["class","cropper",3,"rounded","top","left","width","height","margin-left","visibility",4,"ngIf"],[1,"cropper"],[1,"move",3,"mousedown","touchstart"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(s.Wb(0,"div"),s.Wb(1,"img",0,1),s.ic("load",(function(){return e.imageLoadedInView()})),s.Vb(),s.Oc(3,l,23,14,"div",2),s.Vb()),2&t&&(s.Nc("background",e.imageVisible&&e.backgroundColor,s.Jb),s.Cb(1),s.Nc("visibility",e.imageVisible?"visible":"hidden"),s.sc("src",e.safeImgDataUrl,s.Ic),s.Cb(2),s.sc("ngIf",e.imageVisible))},directives:[r.u],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{position:relative;width:100%}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;touch-action:none;outline:rgba(255,255,255,.3) solid 100vw}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3)}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3)}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}'],changeDetection:0}),f),b=((u=function t(){_classCallCheck(this,t)}).\u0275mod=s.Ob({type:u}),u.\u0275inj=s.Nb({factory:function(t){return new(t||u)},imports:[[r.c]]}),u),v=i("n6pr"),y=i("mYbV"),C=i("aSpy"),M=i("SEFB"),x=i("dOUP"),k=i("R8lv"),S=i("Cfvw"),w=i("z6cu"),P=i("nYR2"),O=i("eIep"),I=i("JIr8"),R=i("/Tzu"),z=((d=function(){function t(e){_classCallCheck(this,t),this.activeModal=e,this.imageChangedEvent=""}return _createClass(t,[{key:"ngOnInit",value:function(){null!=this.image&&this.blobToBase64Image(this.image)}},{key:"blobToBase64Image",value:function(t){var e=this,i=new FileReader;i.addEventListener("load",(function(){i.result&&(e.imageCropper.imageBase64=i.result)}),!1),t&&i.readAsDataURL(t)}},{key:"populateFormData",value:function(t){this.formData=new FormData,this.formData.append("studentprofilephoto",t,t.name)}},{key:"uploadPicture",value:function(){this.activeModal.close(this.formData)}},{key:"fileChangeEvent",value:function(t){this.imageChangedEvent=t;var e=t.target.files[0];e&&this.populateFormData(e)}},{key:"imageCropped",value:function(t){this.populateFormData(t.file)}},{key:"rotateLeft",value:function(){this.imageCropper.rotateLeft()}},{key:"rotateRight",value:function(){this.imageCropper.rotateRight()}},{key:"flipHorizontal",value:function(){this.imageCropper.flipHorizontal()}},{key:"flipVertical",value:function(){this.imageCropper.flipVertical()}}]),t}()).\u0275fac=function(t){return new(t||d)(s.Qb(a.a))},d.\u0275cmp=s.Kb({type:d,selectors:[["tm-upload-edit-profile-picture-modal"]],viewQuery:function(t,e){var i;1&t&&s.Wc(m,!0),2&t&&s.Bc(i=s.jc())&&(e.imageCropper=i.first)},inputs:{image:"image"},decls:30,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-hidden","true",1,"close",3,"click"],[1,"modal-body","align-center"],[1,"row"],[1,"col","sm-5"],[1,"col-md-4"],["type","file",1,"row","col","student-photo",3,"change"],[1,"col-md-8","pl-md-5"],["ngbTooltip","Flip Horizontally",1,"btn","btn-primary","btn-space",3,"click"],[1,"fas","fa-angle-double-left"],["ngbTooltip","Flip Vertically",1,"btn","btn-primary","btn-space",3,"click"],[1,"fas","fa-angle-double-up"],["ngbTooltip","Rotate Anti-clockwise",1,"btn","btn-primary","btn-space",3,"click"],[1,"fas","fa-redo-alt","fa-flip-horizontal"],["ngbTooltip","Rotate Clockwise",1,"btn","btn-primary","btn-space",3,"click"],[1,"fas","fa-redo-alt"],[3,"imageChangedEvent","maintainAspectRatio","imageCropped"],[1,"modal-footer"],[1,"btn","btn-success","btn-lg","profile-upload-picture-submit",3,"click"]],template:function(t,e){1&t&&(s.Wb(0,"div",0),s.Wb(1,"h4",1),s.Qc(2," Upload/Edit Photo "),s.Vb(),s.Wb(3,"button",2),s.ic("click",(function(){return e.activeModal.dismiss()})),s.Qc(4," \xd7 "),s.Vb(),s.Vb(),s.Wb(5,"div",3),s.Wb(6,"div",4),s.Wb(7,"div",5),s.Wb(8,"p"),s.Qc(9,"If you have no profile picture, upload one from your computer. Once a picture is uploaded, you will be able to edit it using the buttons below. Cropping is available by adjusting the box size. "),s.Vb(),s.Vb(),s.Vb(),s.Wb(10,"div",4),s.Wb(11,"div",6),s.Wb(12,"input",7),s.ic("change",(function(t){return e.fileChangeEvent(t)})),s.Vb(),s.Wb(13,"small"),s.Qc(14,"Max Size: 5MB"),s.Vb(),s.Vb(),s.Wb(15,"div",8),s.Wb(16,"button",9),s.ic("click",(function(){return e.flipHorizontal()})),s.Rb(17,"i",10),s.Vb(),s.Wb(18,"button",11),s.ic("click",(function(){return e.flipVertical()})),s.Rb(19,"i",12),s.Vb(),s.Wb(20,"button",13),s.ic("click",(function(){return e.rotateLeft()})),s.Rb(21,"i",14),s.Vb(),s.Wb(22,"button",15),s.ic("click",(function(){return e.rotateRight()})),s.Rb(23,"i",16),s.Vb(),s.Vb(),s.Vb(),s.Wb(24,"div",4),s.Wb(25,"image-cropper",17),s.ic("imageCropped",(function(t){return e.imageCropped(t)})),s.Vb(),s.Vb(),s.Vb(),s.Wb(26,"div",18),s.Wb(27,"div"),s.Wb(28,"button",19),s.ic("click",(function(){return e.uploadPicture()})),s.Qc(29,"Upload Image"),s.Vb(),s.Vb(),s.Vb()),2&t&&(s.Cb(25),s.sc("imageChangedEvent",e.imageChangedEvent)("maintainAspectRatio",!1))},directives:[a.w,m],styles:[".btn-space[_ngcontent-%COMP%]{margin-right:var(--btn-margin)}"]}),d),W=i("eQqG"),_=i("vMQM"),V=i("mW1j"),A=((g=function(){function t(e){_classCallCheck(this,t),this.httpRequestService=e}return _createClass(t,[{key:"getNationalities",value:function(){return this.httpRequestService.get(_.d.NATIONALITIES)}}]),t}()).\u0275fac=function(t){return new(t||g)(s.ec(V.a))},g.\u0275prov=s.Mb({token:g,factory:g.\u0275fac,providedIn:"root"}),g),T=i("nAaM"),F=i("Uqoa"),L=i("Rjy1"),E=i("Babz"),N=i("Lcal"),D=i("Wsbs"),Q=i("UGSt"),B=i("WbH0");function H(t,e){if(1&t){var i=s.Xb();s.Wb(0,"button",27),s.ic("click",(function(){return s.Fc(i),s.kc(3).onDelete()})),s.Qc(1," Delete Photo "),s.Vb()}}function U(t,e){if(1&t&&(s.Wb(0,"option",28),s.Qc(1),s.Vb()),2&t){var i=e.$implicit;s.sc("value",i),s.Cb(1),s.Sc(" ",i," ")}}function j(t,e){if(1&t&&(s.Wb(0,"div",29),s.Rb(1,"input",30),s.Wb(2,"label",31),s.Qc(3),s.lc(4,"genderFormat"),s.Vb(),s.Vb()),2&t){var i=e.$implicit;s.Cb(1),s.sc("value",i),s.Cb(2),s.Rc(s.mc(4,2,i))}}function X(t,e){1&t&&s.Rb(0,"tm-ajax-loading")}function G(t,e){if(1&t){var i=s.Xb();s.Wb(0,"div",4),s.Wb(1,"div",5),s.Wb(2,"h1"),s.Qc(3),s.Vb(),s.Wb(4,"div",6),s.Wb(5,"div",7),s.Wb(6,"img",8),s.ic("click",(function(){return s.Fc(i),s.kc(2).onUploadEdit()}))("error",(function(){return s.Fc(i),s.kc(2).setDefaultPic()})),s.Vb(),s.Vb(),s.Vb(),s.Wb(7,"div",6),s.Wb(8,"div",9),s.Wb(9,"button",10),s.ic("click",(function(){return s.Fc(i),s.kc(2).onUploadEdit()})),s.Qc(10," Upload/Edit Photo "),s.Vb(),s.Oc(11,H,2,0,"button",11),s.Vb(),s.Vb(),s.Wb(12,"form",12),s.ic("ngSubmit",(function(){return s.Fc(i),s.kc(2).onSubmit()})),s.Wb(13,"div",13),s.Wb(14,"label"),s.Qc(15,"The name you prefer to be called by instructors"),s.Vb(),s.Rb(16,"input",14),s.Vb(),s.Wb(17,"div",13),s.Wb(18,"label"),s.Qc(19," Long-term Contact Email "),s.Wb(20,"em",15),s.Qc(21,"- only visible to your instructors"),s.Vb(),s.Vb(),s.Rb(22,"input",16),s.Vb(),s.Wb(23,"div",13),s.Wb(24,"label"),s.Qc(25,"Institute"),s.Vb(),s.Rb(26,"input",17),s.Vb(),s.Wb(27,"div",13),s.Wb(28,"label"),s.Qc(29,"Nationality"),s.Vb(),s.Wb(30,"select",18),s.Oc(31,U,2,2,"option",19),s.Vb(),s.Vb(),s.Wb(32,"label"),s.Qc(33,"Gender"),s.Vb(),s.Wb(34,"div",13),s.Oc(35,j,5,4,"div",20),s.lc(36,"enumToArray"),s.Vb(),s.Wb(37,"div",13),s.Wb(38,"label",21),s.Qc(39," More Information about Yourself"),s.Vb(),s.Wb(40,"textarea",22),s.Qc(41,"            "),s.Vb(),s.Vb(),s.Wb(42,"div",23),s.Wb(43,"button",24),s.Oc(44,X,1,0,"tm-ajax-loading",25),s.Qc(45," Save Profile "),s.Vb(),s.Vb(),s.Wb(46,"div",26),s.Qc(47,"This profile will be visible to all your instructors and coursemates."),s.Vb(),s.Vb(),s.Vb(),s.Vb()}if(2&t){var r=s.kc(2);s.Cb(3),s.Rc(r.name),s.Cb(3),s.tc("src",r.profilePicLink,s.Ic),s.Cb(5),s.sc("ngIf",r.profilePicLink!=r.defaultPictureLink),s.Cb(1),s.sc("formGroup",r.editForm),s.Cb(19),s.sc("ngForOf",r.nationalities),s.Cb(4),s.sc("ngForOf",s.mc(36,8,r.Gender)),s.Cb(8),s.sc("disabled",r.isSavingProfileEdit),s.Cb(1),s.sc("ngIf",r.isSavingProfileEdit)}}function Y(t,e){if(1&t&&(s.Wb(0,"div",2),s.Wb(1,"h1"),s.Qc(2,"Student Profile"),s.Vb(),s.Oc(3,G,48,10,"div",3),s.Vb()),2&t){var i=s.kc();s.Cb(3),s.sc("ngIf",i.student)}}var K,q,J=[{path:"",component:(K=function(){function t(e,i,r,n,o,a){_classCallCheck(this,t),this.simpleModalService=e,this.nationalitiesService=i,this.authService=r,this.ngbModal=n,this.statusMessageService=o,this.studentProfileService=a,this.Gender=k.h,this.id="",this.defaultPictureLink="/assets/images/profile_picture_default.png",this.isLoadingStudentProfile=!1,this.hasLoadingStudentProfileFailed=!1,this.isSavingProfileEdit=!1,this.backendUrl=x.a.backendUrl}return _createClass(t,[{key:"ngOnInit",value:function(){this.initNationalities(),this.loadStudentProfile()}},{key:"initNationalities",value:function(){var t=this;this.nationalitiesService.getNationalities().subscribe((function(e){t.nationalities=e.nationalities}))}},{key:"loadStudentProfile",value:function(){var t=this;this.hasLoadingStudentProfileFailed=!1,this.isLoadingStudentProfile=!0,this.authService.getAuthUser().subscribe((function(e){e.user&&(t.id=e.user.id,t.profilePicLink="".concat(t.backendUrl,"/webapi/student/profilePic?user=").concat(t.id),t.studentProfileService.getStudentProfile().pipe(Object(P.a)((function(){return t.isLoadingStudentProfile=!1}))).subscribe((function(e){e?(t.student=e,t.name=e.name,t.initStudentProfileForm(t.student)):(t.hasLoadingStudentProfileFailed=!0,t.statusMessageService.showErrorToast("Error retrieving student profile"))}),(function(e){t.hasLoadingStudentProfileFailed=!0,t.statusMessageService.showErrorToast(e.error.message)})))}))}},{key:"initStudentProfileForm",value:function(t){this.editForm=new n.h({studentshortname:new n.f(t.shortName),studentprofileemail:new n.f(t.email),studentprofileinstitute:new n.f(t.institute),studentnationality:new n.f(t.nationality),existingNationality:new n.f(t.nationality),studentgender:new n.f(t.gender),studentprofilemoreinfo:new n.f(t.moreInfo)})}},{key:"onSubmit",value:function(){var t=this;this.simpleModalService.openConfirmationModal("Save Changes?",R.a.INFO,"Are you sure you want to make changes to your profile?").result.then((function(){return t.submitEditForm()}),(function(){}))}},{key:"onUploadEdit",value:function(){var t=this;this.studentProfileService.getProfilePicture().pipe(Object(O.a)((function(e){var i=t.ngbModal.open(z);return i.componentInstance.image=e,Object(S.a)(i.result)})),Object(I.a)((function(){return Object(w.a)({error:{message:"No image uploaded"},status:600})})),Object(O.a)((function(e){return t.studentProfileService.postProfilePicture(e)}))).subscribe((function(){t.statusMessageService.showSuccessToast("Your profile picture has been saved successfully");var e=(new Date).getTime();t.profilePicLink="".concat(t.backendUrl,"/webapi/student/profilePic?").concat(e,"&user=").concat(t.id)}),(function(e){600!==e.status&&t.statusMessageService.showErrorToast(e.error.message)}))}},{key:"submitEditForm",value:function(){var t=this;this.isSavingProfileEdit=!0,this.studentProfileService.updateStudentProfile(this.id,{shortName:this.editForm.controls.studentshortname.value,email:this.editForm.controls.studentprofileemail.value,institute:this.editForm.controls.studentprofileinstitute.value,nationality:this.editForm.controls.studentnationality.value,gender:this.editForm.controls.studentgender.value,moreInfo:this.editForm.controls.studentprofilemoreinfo.value,existingNationality:this.editForm.controls.existingNationality.value}).pipe(Object(P.a)((function(){return t.isSavingProfileEdit=!1}))).subscribe((function(e){e&&t.statusMessageService.showSuccessToast(e.message)}),(function(e){t.statusMessageService.showErrorToast("Could not save your profile! "+e.error.message)}))}},{key:"onDelete",value:function(){var t=this;this.simpleModalService.openConfirmationModal("Delete profile picture?",R.a.DANGER,"Warning: Profile picture cannot be recovered.").result.then((function(){t.deleteProfilePicture()}),(function(){}))}},{key:"deleteProfilePicture",value:function(){var t=this;this.studentProfileService.deleteProfilePicture({googleid:this.id}).subscribe((function(e){e&&(t.statusMessageService.showSuccessToast(e.message),t.profilePicLink="/assets/images/profile_picture_default.png")}),(function(e){t.statusMessageService.showErrorToast("Could not delete your profile picture! "+e.error.message)}))}},{key:"setDefaultPic",value:function(){this.profilePicLink=this.defaultPictureLink}}]),t}(),K.\u0275fac=function(t){return new(t||K)(s.Qb(W.a),s.Qb(A),s.Qb(T.a),s.Qb(a.m),s.Qb(F.a),s.Qb(L.a))},K.\u0275cmp=s.Kb({type:K,selectors:[["tm-student-profile-page"]],decls:2,vars:3,consts:[[3,"shouldShowRetry","message","retryEvent"],["class","text-center text-sm-left",4,"tmIsLoading"],[1,"text-center","text-sm-left"],["class","card",4,"ngIf"],[1,"card"],[1,"card-body","fill-plain"],[1,"row","profile-pic-row"],[1,"col","cursor-pointer"],[1,"profile-pic",3,"src","click","error"],[1,"col-md-12","cursor-pointer"],["ngbTooltip",".jpg or .png, max size 5 MB",1,"btn","btn-primary","upload-edit-photo","btn-margin-right",3,"click"],["id","profile-delete-photo","class","btn btn-danger",3,"click",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-group"],["id","studentshortname","formControlName","studentshortname",1,"form-control"],[1,"font-weight-normal","emphasis","text-muted","small"],["id","studentprofileemail","formControlName","studentprofileemail",1,"form-control"],["id","studentprofileinstitute","formControlName","studentprofileinstitute",1,"form-control"],["id","studentnationality","formControlName","studentnationality",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","custom-control-inline",4,"ngFor","ngForOf"],["ngbTooltip","You may specify miscellaneous info about yourself e.g. links to home page, online CV, portfolio etc",1,"ngb-tooltip-class"],["id","studentprofilemoreinfo","rows","4","formControlName","studentprofilemoreinfo","placeholder","You may specify miscellaneous info about yourself e.g. links to home page, online CV, portfolio etc.",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary","student-save-profile",3,"disabled"],[4,"ngIf"],[1,"whisper"],["id","profile-delete-photo",1,"btn","btn-danger",3,"click"],[3,"value"],[1,"custom-control-inline"],["type","radio","formControlName","studentgender",1,"student-gender-radio",3,"value"],[1,"student-gender-label","mt-1"]],template:function(t,e){1&t&&(s.Wb(0,"tm-loading-retry",0),s.ic("retryEvent",(function(){return e.loadStudentProfile()})),s.Oc(1,Y,4,1,"div",1),s.Vb()),2&t&&(s.sc("shouldShowRetry",e.hasLoadingStudentProfileFailed)("message","Failed to load profile"),s.Cb(1),s.sc("tmIsLoading",e.isLoadingStudentProfile))},directives:[E.a,N.a,r.u,a.w,n.F,n.q,n.i,n.c,n.p,n.g,n.B,r.t,n.u,n.E,n.x,D.a],pipes:[Q.a,B.a],styles:[".fill-plain[_ngcontent-%COMP%]{background-color:#eaeff5}label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:5px}select[_ngcontent-%COMP%]{width:300px}.student-gender-radio[_ngcontent-%COMP%]{margin-right:5px}.student-gender-label[_ngcontent-%COMP%]{font-weight:400}.whisper[_ngcontent-%COMP%]{margin-top:15px;font-style:italic;color:grey}.profile-pic[_ngcontent-%COMP%]{height:220px;width:220px}.profile-pic-row[_ngcontent-%COMP%]{margin-bottom:1rem}"]}),K)}],$=((q=function t(){_classCallCheck(this,t)}).\u0275mod=s.Ob({type:q}),q.\u0275inj=s.Nb({factory:function(t){return new(t||q)},imports:[[r.c,n.z,o.h.forChild(J),M.a,b,a.y,C.a,v.a,y.a]]}),q)},ax2R:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("XNiG"),n=i("fXoL"),o=function(){var t=function(){function t(){_classCallCheck(this,t),this.progressPercentage=new r.a}return _createClass(t,[{key:"updateProgress",value:function(t){this.progressPercentage.next(t)}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},eQqG:function(t,e,i){"use strict";i.d(e,"a",(function(){return S}));var r,n=i("fXoL"),o=i("/Tzu"),a=i("1kSV"),s=i("ofXK"),c=i("ax2R"),p=((r=function(){function t(e){_classCallCheck(this,t),this.progressBarService=e,this.progressPercentage=0}return _createClass(t,[{key:"ngOnInit",value:function(){this.getProgress()}},{key:"getProgress",value:function(){var t=this;this.progressBarService.progressPercentage.subscribe((function(e){t.progressPercentage=e}))}}]),t}()).\u0275fac=function(t){return new(t||r)(n.Qb(c.a))},r.\u0275cmp=n.Kb({type:r,selectors:[["tm-progress-bar"]],decls:2,vars:3,consts:[["type","info","height","26px","showValue","true",3,"value","striped","animated"]],template:function(t,e){1&t&&(n.Wb(0,"div"),n.Rb(1,"ngb-progressbar",0),n.Vb()),2&t&&(n.Cb(1),n.sc("value",e.progressPercentage)("striped",!0)("animated",!0))},directives:[a.q],encapsulation:2}),r);function l(t,e){1&t&&n.Rb(0,"i",16)}function h(t,e){1&t&&n.Rb(0,"i",17)}function u(t,e){1&t&&n.Rb(0,"i",18)}function f(t,e){1&t&&n.Sb(0)}function d(t,e){if(1&t&&(n.Wb(0,"div"),n.Oc(1,f,1,0,"ng-container",19),n.Vb()),2&t){var i=n.kc();n.Cb(1),n.sc("ngTemplateOutlet",i.content)}}function g(t,e){if(1&t&&n.Rb(0,"div",20),2&t){var i=n.kc();n.sc("innerHTML",i.content,n.Gc)}}function m(t,e){1&t&&(n.Wb(0,"div",21),n.Rb(1,"tm-progress-bar"),n.Vb())}function b(t,e){if(1&t){var i=n.Xb();n.Wb(0,"button",22),n.ic("click",(function(){return n.Fc(i),n.kc().activeModal.dismiss()})),n.Qc(1),n.Vb()}if(2&t){var r=n.kc();n.Cb(1),n.Sc(" ",r.cancelMessage," ")}}var v,y,C=function(t){return{"display-none":t}},M=function(t,e,i,r){return{"alert-danger":t,"alert-warning":e,"alert-info":i,"bg-white":r}},x=function(t,e,i,r){return{"btn-danger":t,"btn-warning":e,"btn-info":i,"btn-primary":r}},k=((y=function(){function t(e){_classCallCheck(this,t),this.activeModal=e,this.SimpleModalType=o.a,this.header="",this.content="",this.type=o.a.NEUTRAL,this.isInformationOnly=!1,this.confirmMessage="Yes",this.cancelMessage="No, cancel the operation"}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"isTemplate",get:function(){return this.content instanceof n.L}}]),t}()).\u0275fac=function(t){return new(t||y)(n.Qb(a.a))},y.\u0275cmp=n.Kb({type:y,selectors:[["tm-confirmation-modal"]],inputs:{header:"header",content:"content",type:"type",isInformationOnly:"isInformationOnly",confirmMessage:"confirmMessage",cancelMessage:"cancelMessage"},decls:18,vars:24,consts:[[1,"transparent-overlay",3,"ngClass"],[1,"modal-header",3,"ngClass"],[1,"modal-title"],["class","fas fa-times-circle",4,"ngIf"],["class","fas fa-exclamation-circle",4,"ngIf"],["class","fas fa-info-circle",4,"ngIf"],[1,"margin-left-5px",3,"innerHTML"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"modal-body"],[4,"ngIf"],[3,"innerHTML",4,"ngIf"],["class","progress-bar-container",4,"ngIf"],[1,"modal-footer"],["type","button","class","btn btn-light modal-btn-cancel",3,"click",4,"ngIf"],["type","button",1,"btn","modal-btn-ok","z-index-1",3,"ngClass","click"],[1,"fas","fa-times-circle"],[1,"fas","fa-exclamation-circle"],[1,"fas","fa-info-circle"],[4,"ngTemplateOutlet"],[3,"innerHTML"],[1,"progress-bar-container"],["type","button",1,"btn","btn-light","modal-btn-cancel",3,"click"]],template:function(t,e){1&t&&(n.Rb(0,"div",0),n.Wb(1,"div",1),n.Wb(2,"div"),n.Wb(3,"h5",2),n.Oc(4,l,1,0,"i",3),n.Oc(5,h,1,0,"i",4),n.Oc(6,u,1,0,"i",5),n.Rb(7,"span",6),n.Vb(),n.Vb(),n.Wb(8,"button",7),n.ic("click",(function(){return e.type===e.SimpleModalType.LOAD?e.activeModal.close():e.activeModal.dismiss()})),n.Rb(9,"i",8),n.Vb(),n.Vb(),n.Wb(10,"div",9),n.Oc(11,d,2,1,"div",10),n.Oc(12,g,1,1,"div",11),n.Oc(13,m,2,0,"div",12),n.Vb(),n.Wb(14,"div",13),n.Oc(15,b,2,1,"button",14),n.Wb(16,"button",15),n.ic("click",(function(){return e.activeModal.close()})),n.Qc(17),n.Vb(),n.Vb()),2&t&&(n.sc("ngClass",n.wc(12,C,e.type!==e.SimpleModalType.LOAD)),n.Cb(1),n.sc("ngClass",n.zc(14,M,e.type===e.SimpleModalType.DANGER,e.type===e.SimpleModalType.WARNING,e.type===e.SimpleModalType.INFO||e.type===e.SimpleModalType.LOAD,e.type===e.SimpleModalType.NEUTRAL)),n.Cb(3),n.sc("ngIf",e.type===e.SimpleModalType.DANGER),n.Cb(1),n.sc("ngIf",e.type===e.SimpleModalType.WARNING),n.Cb(1),n.sc("ngIf",e.type===e.SimpleModalType.INFO||e.type===e.SimpleModalType.LOAD),n.Cb(1),n.sc("innerHTML",e.header,n.Gc),n.Cb(4),n.sc("ngIf",e.isTemplate),n.Cb(1),n.sc("ngIf",!e.isTemplate),n.Cb(1),n.sc("ngIf",e.type===e.SimpleModalType.LOAD),n.Cb(2),n.sc("ngIf",!e.isInformationOnly),n.Cb(1),n.sc("ngClass",n.zc(19,x,e.type===e.SimpleModalType.DANGER||e.type===e.SimpleModalType.LOAD,e.type===e.SimpleModalType.WARNING,e.type===e.SimpleModalType.INFO,e.type===e.SimpleModalType.NEUTRAL)),n.Cb(1),n.Rc(e.confirmMessage))},directives:[s.r,s.u,s.B,p],styles:[".margin-left-5px[_ngcontent-%COMP%]{margin-left:5px}.progress-bar-container[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:2px}.transparent-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;visibility:false;z-index:0}.display-none[_ngcontent-%COMP%]{display:none}.z-index-1[_ngcontent-%COMP%]{z-index:1}"]}),y),S=((v=function(){function t(e){_classCallCheck(this,t),this.ngbModal=e}return _createClass(t,[{key:"open",value:function(t,e,i,r){var n=this.ngbModal.open(k);return n.componentInstance.header=t,n.componentInstance.content=i,n.componentInstance.type=e,r&&Object.entries(r).map((function(t){var e=_slicedToArray(t,2),i=e[0],r=e[1];n.componentInstance[i]=r})),n}},{key:"openConfirmationModal",value:function(t,e,i,r){var n=Object.assign({isInformationOnly:!1,confirmMessage:"Yes",cancelMessage:"No, cancel the operation"},r);return this.open(t,e,i,n)}},{key:"openInformationModal",value:function(t,e,i,r){var n=Object.assign({isInformationOnly:!0,confirmMessage:"OK"},r);return this.open(t,e,i,n)}},{key:"openLoadingModal",value:function(t,e,i,r){var n=Object.assign({isInformationOnly:!0,confirmMessage:"Abort"},r);return this.open(t,e,i,n)}}]),t}()).\u0275fac=function(t){return new(t||v)(n.ec(a.m))},v.\u0275prov=n.Mb({token:v,factory:v.\u0275fac,providedIn:"root"}),v)},mYbV:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("ofXK"),n=i("fXoL"),o=function(){var t=function t(){_classCallCheck(this,t)};return t.\u0275mod=n.Ob({type:t}),t.\u0275inj=n.Nb({factory:function(e){return new(e||t)},imports:[[r.c]]}),t}()}}]);