<div *ngIf="coursePresent">
  <h1>Enroll Students for {{ courseid }}</h1>
  <div class="card card-primary">
    <div class="card-body fill-plain">
      <p class="text-muted">
        <i class="fas fa-info-circle"></i>
        <a tabindex="0" role="button" (click)="navigateToMoreInfo()"> <!--We are just treating it as a button here-->
          Scroll down
        </a>
        to see more information about the spreadsheet interfaces.
        <br>
        <i class="fas fa-info-circle"></i> If you want to enroll more than
        <strong>100</strong> students into one course, divide students into sections containing no more than
        <strong>100</strong> students.<br>
      </p>
      <div class="col-md-12">
        <tm-status-message
            [messages]="statusMessage">
        </tm-status-message>
        <div class="card card-default"
             (click)="togglePanel($event)">
          <div class="card-header">
            <div class="float-right margin-left-7px">
              <i class="fas fa-chevron-up"></i>
            </div>
            <div class='float-right'></div>
            <strong>New students</strong>
          </div>
          <hot-table
              [hotId]="newStudentsHOT"
              [height]="500"
              [autoWrapRow]="true"
              [preventOverflow]="'horizontal'"
              [manualColumnResize]="true"
              [manualRowResize]="true"
              [manualColumnMove]="true"
              [rowHeaders]="true"
              [colHeaders]="colHeaders"
              [columnSorting]="true"
              [minRows]="20"
              [maxCols]="5"
              [maxRows]="100"
              [stretchH]="'all'"
              [minSpareRows]="1"
              [hidden]="isCollapsed">
          </hot-table>
        </div>
        <div class="row enroll-students-spreadsheet-buttons" [hidden]="isCollapsed">
          <div class="col-md-6">
            <div class="input-group">
              <button type="button" title="Add" id="button_add_empty_rows" class="btn btn-primary" (click)="addRows(numOfRows.value)">
                Add row(s)
              </button>
              <div class="col-xs-4">
                <input type="number" id="number-of-rows" class="form-control" value="1" min="0" #numOfRows>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <button type="submit" title="Enroll" id="button_enroll" name="button_enroll" class="btn btn-primary float-right">
              Enroll students
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="more-info" #moreInfo>
    <h2> More info </h2>
    <hr>
    <ul>
      <li>
        <span class="more-info-point-title">Spreadsheet Information</span>
        <ul>
          <li>
            If you have student data in a spreadsheet, simply copy the relevant cell-range from your spreadsheet and
            paste into the <code>New students</code> spreadsheet interface above.<br><br>
            <table class="table table-striped table-bordered">
              <tbody><tr>
                <th>Section</th>
                <th>Team</th>
                <th>Name</th>
                <th>Email</th>
                <th>Comments</th>
              </tr>
              <tr>
                <td>Tutorial Group 1</td>
                <td>Team 1</td>
                <td>Tom Jacobs</td>
                <td>tom@example.com</td>
                <td></td>
              </tr>
              <tr>
                <td>Tutorial Group 1</td>
                <td>Team 1</td>
                <td>Jean Wong</td>
                <td>jean@example.com</td>
                <td>Exchange Student</td>
              </tr>
              <tr>
                <td>Tutorial Group 1</td>
                <td>Team 1</td>
                <td>Ravi Kumar</td>
                <td>ravi@example.com</td>
                <td></td>
              </tr>
              <tr>
                <td>Tutorial Group 2</td>
                <td>Team 2</td>
                <td>Chun Ling</td>
                <td>ling@example.com</td>
                <td></td>
              </tr>
              <tr>
                <td>Tutorial Group 2</td>
                <td>Team 2</td>
                <td>Desmond Wu</td>
                <td>desmond@example.com</td>
                <td></td>
              </tr>
              <tr>
                <td>Tutorial Group 2</td>
                <td>Team 3</td>
                <td>Harsha Silva</td>
                <td>harsha@example.com</td>
                <td></td>
              </tr>
              </tbody></table>
          </li>
          <li>Each existing cells can be edited by just clicking on it.</li>
          <li>The entire table can be sorted by just clicking on the column name.</li>
          <li>You can re-arrange column order by clicking on the column header and dragging them left or right.</li>
          <li>To access more edit functions, right-click on a cell.</li>
          <li>Column width can be adjusted.</li>
          <li>Expand the <code>Existing students</code> spreadsheet interface to view existing students in the course.</li>
        </ul>
      </li>
      <li>
        <span class="more-info-point-title">Columns Information</span>
        <ul>
          <li class="more-info-column-info">
            <samp>Section</samp> [Compulsory for courses having more than 100 students]: Section name/ID
          </li>
          <li class="more-info-column-info">
            <samp>Team</samp> [Compulsory]: Team name/ID
            <ul>
              <li class="more-info-sub-point-details">
                A team must be unique within a course. A team cannot be in 2 different sections.
              </li>
              <li class="more-info-sub-point-details">
                If you do not have teams in your course, use “N/A” as the team name for all students.
              </li>
            </ul>
          </li>
          <li class="more-info-column-info">
            <samp>Name</samp> [Compulsory]: Student name
          </li>
          <li class="more-info-column-info">
            <samp>Email</samp> [Compulsory]: The email address used to contact the student.<br>
            <ul>
              <li class="more-info-sub-point-details">
                This need not be a Gmail address.
              </li>
              <li class="more-info-sub-point-details">
                It should be unique for each student.
                If two students are given the same email, they will be considered the same student.
              </li>
            </ul>
          </li>
          <li class="more-info-column-info">
            <samp>Comments</samp> [Optional]: Any other information you want to record about a student.
          </li>
        </ul>
      </li>
      <li>
        <span class="more-info-point-title">Mass editing enrolled students</span>
        <ul>
          <li>
            To mass-edit data of enrolled students (except email address), simply use this page to re-enroll them with
            the
            updated data.
          </li>
          <li>
            To DELETE students or to UPDATE EMAIL address of a student, please go to the <code>courses</code> page and
            click the <code>Students -&gt; View/Edit</code> link of the course.
          </li>
        </ul>
      </li>
    </ul>
  </div>
</div>
