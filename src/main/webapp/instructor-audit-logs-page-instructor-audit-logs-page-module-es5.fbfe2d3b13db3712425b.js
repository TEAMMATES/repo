function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,n=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"2gUZ":function(e,t,o){"use strict";o.r(t),o.d(t,"InstructorAuditLogsPageModule",(function(){return B}));var n=o("ofXK"),r=o("3Pt+"),i=o("tyNb"),a=o("1kSV"),s=o("aSpy"),c=o("RPsU"),u=o("qVc+"),l=o("9Jqy"),d=o("pjmv"),f=o.n(d),b=o("cp0P"),m=o("bOdf"),g=o("nYR2"),h=o("bHdf"),p=o("lJxs"),v=o("A3DQ"),y=o("vMQM"),C=o("R8lv"),S=o("p6cw"),T=o("oQl6"),M=o("fXoL"),O=o("vKUq"),k=o("iRmZ"),_=o("65rL"),D=o("Uqoa"),V=o("Lcal"),I=o("tvVI"),E=o("zAMY"),W=o("h8PG");function w(e,t){if(1&e&&(M.Wb(0,"option"),M.Qc(1),M.Vb()),2&e){var o=t.$implicit;M.Cb(1),M.Sc(" ",o.courseId," ")}}function F(e,t){if(1&e&&(M.Wb(0,"option",30),M.Qc(1),M.Vb()),2&e){var o=t.$implicit;M.sc("value",o.email),M.Cb(1),M.Tc(" ",o.name," ",o.email?"<"+o.email+">":""," ")}}function L(e,t){if(1&e){var o=M.Xb();M.Wb(0,"div",2),M.Wb(1,"div",3),M.Wb(2,"div",4),M.Wb(3,"div",5),M.Wb(4,"div",6),M.Wb(5,"label",7),M.Qc(6,"Course ID"),M.Vb(),M.Vb(),M.Wb(7,"div",6),M.Wb(8,"select",8),M.ic("ngModelChange",(function(e){return M.Fc(o),M.kc().formModel.courseId=e})),M.Wb(9,"option",9),M.Qc(10,"Select Course ID"),M.Vb(),M.Oc(11,w,2,1,"option",10),M.Vb(),M.Vb(),M.Vb(),M.Wb(12,"div",11),M.Wb(13,"div",12),M.Wb(14,"label",13),M.Qc(15,"Search period from"),M.Vb(),M.Vb(),M.Wb(16,"div",14),M.Wb(17,"div",15),M.Wb(18,"input",16,17),M.ic("ngModelChange",(function(e){return M.Fc(o),M.kc().formModel.logsDateFrom=e})),M.Vb(),M.Wb(20,"button",18),M.ic("click",(function(){return M.Fc(o),M.Cc(19).toggle()})),M.Rb(21,"i",19),M.Vb(),M.Vb(),M.Wb(22,"div",20),M.Wb(23,"tm-time-picker",21),M.ic("timeChange",(function(e){return M.Fc(o),M.kc().formModel.logsTimeFrom=e})),M.Vb(),M.Vb(),M.Vb(),M.Vb(),M.Vb(),M.Wb(24,"div",4),M.Wb(25,"div",5),M.Wb(26,"div",6),M.Wb(27,"label",22),M.Qc(28,"Student Name (Optional)"),M.Vb(),M.Vb(),M.Wb(29,"div",6),M.Wb(30,"select",23),M.ic("ngModelChange",(function(e){return M.Fc(o),M.kc().formModel.studentEmail=e})),M.Oc(31,F,2,3,"option",24),M.Vb(),M.Vb(),M.Vb(),M.Wb(32,"div",11),M.Wb(33,"div",12),M.Wb(34,"label",25),M.Qc(35,"Search period until"),M.Vb(),M.Vb(),M.Wb(36,"div",14),M.Wb(37,"div",15),M.Wb(38,"input",26,27),M.ic("ngModelChange",(function(e){return M.Fc(o),M.kc().formModel.logsDateTo=e})),M.Vb(),M.Wb(40,"button",18),M.ic("click",(function(){return M.Fc(o),M.Cc(39).toggle()})),M.Rb(41,"i",19),M.Vb(),M.Vb(),M.Wb(42,"div",20),M.Wb(43,"tm-time-picker",21),M.ic("timeChange",(function(e){return M.Fc(o),M.kc().formModel.logsTimeTo=e})),M.Vb(),M.Vb(),M.Wb(44,"div",28),M.Wb(45,"button",29),M.ic("click",(function(){return M.Fc(o),M.kc().search()})),M.Qc(46,"Search"),M.Vb(),M.Vb(),M.Vb(),M.Vb(),M.Vb(),M.Vb(),M.Vb()}if(2&e){var n=M.kc();M.Cb(8),M.sc("ngModel",n.formModel.courseId),M.Cb(3),M.sc("ngForOf",n.courses),M.Cb(7),M.sc("minDate",n.earliestSearchDate)("maxDate",n.dateToday)("ngModel",n.formModel.logsDateFrom),M.Cb(5),M.sc("time",n.formModel.logsTimeFrom),M.Cb(7),M.sc("ngModel",n.formModel.studentEmail),M.Cb(1),M.sc("ngForOf",n.courseToStudents[n.formModel.courseId]),M.Cb(7),M.sc("minDate",n.earliestSearchDate)("maxDate",n.dateToday)("ngModel",n.formModel.logsDateTo),M.Cb(5),M.sc("time",n.formModel.logsTimeTo),M.Cb(2),M.sc("disabled",!n.formModel.courseId||n.isSearching)}}function R(e,t){if(1&e&&(M.Wb(0,"div",3),M.Rb(1,"tm-sortable-table",38),M.Vb()),2&e){var o=M.kc(2).$implicit,n=M.kc(2);M.Cb(1),M.sc("rows",o.logRowsData)("columns",o.logColumnsData)("initialSortBy",n.SortBy.GIVER_NAME)}}function A(e,t){1&e&&(M.Wb(0,"div",39),M.Wb(1,"i"),M.Qc(2,"No activity for this feedback session in selected search period"),M.Vb(),M.Vb())}function P(e,t){if(1&e&&(M.Wb(0,"div"),M.Oc(1,R,2,3,"div",36),M.Oc(2,A,3,0,"ng-template",null,37,M.Pc),M.Vb()),2&e){var o=M.Cc(3),n=M.kc().$implicit;M.Cb(1),M.sc("ngIf",n.logRowsData[0])("ngIfElse",o)}}function N(e,t){if(1&e&&(M.Wb(0,"div"),M.Wb(1,"div",31),M.Wb(2,"div",32),M.ic("click",(function(){var e=t.$implicit;return e.isTabExpanded=!e.isTabExpanded})),M.Qc(3),M.Wb(4,"div",33),M.Rb(5,"tm-panel-chevron",34),M.Vb(),M.Vb(),M.Oc(6,P,4,2,"div",35),M.Vb(),M.Vb()),2&e){var o=t.$implicit;M.Cb(3),M.Sc(" ",o.feedbackSessionName," "),M.Cb(2),M.sc("isExpanded",o.isTabExpanded),M.Cb(1),M.sc("ngIf",o.isTabExpanded)}}function j(e,t){if(1&e&&(M.Wb(0,"div"),M.Oc(1,N,7,3,"div",10),M.Vb()),2&e){var o=M.kc();M.Cb(1),M.sc("ngForOf",o.searchResults)}}var x,Q,Y=[{path:"",component:(x=function(){function e(t,o,n,r,i){_classCallCheck(this,e),this.courseService=t,this.studentService=o,this.logsService=n,this.timezoneService=r,this.statusMessageService=i,this.LOGS_RETENTION_PERIOD=y.a.LOGS_RETENTION_PERIOD,this.SortBy=S.a,this.formModel={logsDateFrom:{year:0,month:0,day:0},logsTimeFrom:{hour:0,minute:0},logsDateTo:{year:0,month:0,day:0},logsTimeTo:{hour:0,minute:0},courseId:"",studentEmail:""},this.dateToday={year:0,month:0,day:0},this.earliestSearchDate={year:0,month:0,day:0},this.courses=[],this.courseToStudents={},this.searchResults=[],this.isLoading=!0,this.isSearching=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=new Date;this.dateToday.year=e.getFullYear(),this.dateToday.month=e.getMonth()+1,this.dateToday.day=e.getDate();var t=new Date(Date.now()-24*this.LOGS_RETENTION_PERIOD*60*60*1e3);this.earliestSearchDate.year=t.getFullYear(),this.earliestSearchDate.month=t.getMonth()+1,this.earliestSearchDate.day=t.getDate(),this.formModel.logsDateFrom=Object.assign(Object.assign({},this.dateToday),{day:e.getDate()-1}),this.formModel.logsDateTo=Object.assign({},this.dateToday),this.formModel.logsTimeFrom={hour:23,minute:59},this.formModel.logsTimeTo={hour:23,minute:59},this.loadData()}},{key:"search",value:function(){var e=this;this.isSearching=!0,this.searchResults=[];var t=[this.resolveLocalDateTime(this.formModel.logsDateFrom,this.formModel.logsTimeFrom,"Search period from"),this.resolveLocalDateTime(this.formModel.logsDateTo,this.formModel.logsTimeTo,"Search period until")];Object(b.a)(t).pipe(Object(m.a)((function(t){return e.logsService.searchFeedbackSessionLog({courseId:e.formModel.courseId,searchFrom:t[0].toString(),searchUntil:t[1].toString(),studentEmail:e.formModel.studentEmail})})),Object(g.a)((function(){return e.isSearching=!1}))).subscribe((function(t){t.feedbackSessionLogs.map((function(t){return e.searchResults.push(e.toFeedbackSessionLogModel(t))}))}),(function(t){return e.statusMessageService.showErrorToast(t.error.message)}))}},{key:"loadData",value:function(){var e=this,t={courseId:"",email:"",name:"",sectionName:"",teamName:""};this.courseService.getAllCoursesAsInstructor("active").pipe(Object(m.a)((function(t){return t.courses.map((function(t){return e.courses.push(t),e.studentService.getStudentsFromCourse({courseId:t.courseId})}))})),Object(h.a)(),Object(g.a)((function(){return e.isLoading=!1}))).subscribe((function(o){return e.courseToStudents[o.students[0].courseId]=[t].concat(_toConsumableArray(o.students))}),(function(t){return e.statusMessageService.showErrorToast(t.error.message)}))}},{key:"resolveLocalDateTime",value:function(e,t,o){var n=f()();n.set("year",e.year),n.set("month",e.month-1),n.set("date",e.day),n.set("hour",t.hour),n.set("minute",t.minute);var r=n.format(v.a);return this.timezoneService.getResolvedTimestamp(r,this.timezoneService.guessTimezone(),o).pipe(Object(p.a)((function(e){return e.timestamp})))}},{key:"toFeedbackSessionLogModel",value:function(e){var t=this;return{isTabExpanded:!1,feedbackSessionName:e.feedbackSessionData.feedbackSessionName,logColumnsData:[{header:"Time",sortBy:S.a.LOG_DATE},{header:"Name",sortBy:S.a.GIVER_NAME},{header:"Activity",sortBy:S.a.LOG_TYPE},{header:"Email",sortBy:S.a.RESPONDENT_EMAIL},{header:"Section",sortBy:S.a.SECTION_NAME},{header:"Team",sortBy:S.a.TEAM_NAME}],logRowsData:e.feedbackSessionLogEntries.map((function(o){return[{value:t.timezoneService.formatToString(o.timestamp,e.feedbackSessionData.timeZone,"ddd, DD MMM, YYYY hh:mm:ss A")},{value:o.studentData.name},{value:C.l[o.feedbackSessionLogType.toString()]===C.l.FEEDBACK_SESSION_ACCESS?"Viewed the submission page":"Submitted responses"},{value:o.studentData.email},{value:o.studentData.sectionName},{value:o.studentData.teamName}]}))}}}]),e}(),x.\u0275fac=function(e){return new(e||x)(M.Qb(O.a),M.Qb(k.a),M.Qb(_.a),M.Qb(v.b),M.Qb(D.a))},x.\u0275cmp=M.Kb({type:x,selectors:[["tm-instructor-audit-logs-page"]],features:[M.Bb([{provide:a.e,useClass:T.a}])],decls:10,vars:3,consts:[["class","card bg-form no-border",4,"tmIsLoading"],[4,"tmIsLoading"],[1,"card","bg-form","no-border"],[1,"card-body"],[1,"row","form-group"],[1,"col-4"],[1,"col-12"],["for","course-id-dropdown",1,"font-weight-bold"],["id","course-id-dropdown",1,"form-control","col-12",3,"ngModel","ngModelChange"],["value","","disabled","","selected","","hidden",""],[4,"ngFor","ngForOf"],[1,"col-8"],[1,"col-12","mb-1"],["for","logs-from-datepicker",1,"font-weight-bold"],[1,"input-group"],[1,"col-md-6","input-group"],["id","logs-from-datepicker","type","text","ngbDatepicker","",1,"form-control",3,"minDate","maxDate","ngModel","ngModelChange"],["logsFromDp","ngbDatepicker"],["type","button",1,"btn","btn-light",3,"click"],[1,"fas","fa-calendar-alt"],[1,"col-md-3"],[3,"time","timeChange"],["for","student-name-dropdown",1,"font-weight-bold"],["id","student-name-dropdown",1,"form-control","col-12",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","logs-to-datepicker",1,"font-weight-bold"],["id","logs-to-datepicker","type","text","ngbDatepicker","",1,"form-control",3,"minDate","maxDate","ngModel","ngModelChange"],["logsToDp","ngbDatepicker"],[1,"col-md-2"],["id","search-button",1,"float-right","btn","btn-primary",3,"disabled","click"],[3,"value"],[1,"card","mb-3","alert-success-border"],[1,"card-header","alert-success","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],[4,"ngIf"],["class","card-body",4,"ngIf","ngIfElse"],["noActivityTemplate",""],[3,"rows","columns","initialSortBy"],[1,"no-activity-body"]],template:function(e,t){1&e&&(M.Wb(0,"h1"),M.Qc(1,"Student Activity Logs"),M.Vb(),M.Wb(2,"p"),M.Qc(3,"This page allows you to find when your students have accessed or submitted a particular feedback session for a given course. The earliest date you can search for is "),M.Wb(4,"b"),M.Qc(5),M.Vb(),M.Qc(6," before today."),M.Vb(),M.Rb(7,"hr"),M.Oc(8,L,47,13,"div",0),M.Oc(9,j,2,1,"div",1)),2&e&&(M.Cb(5),M.Sc("",t.LOGS_RETENTION_PERIOD," days"),M.Cb(3),M.sc("tmIsLoading",t.isLoading),M.Cb(1),M.sc("tmIsLoading",t.isSearching))},directives:[V.a,r.B,r.p,r.s,r.u,r.E,n.t,a.l,r.c,I.a,E.a,n.u,W.a],styles:[".bg-form[_ngcontent-%COMP%]{background-color:#eaeff5}.no-border[_ngcontent-%COMP%]{border:0}.alert-success-border[_ngcontent-%COMP%]{border-color:#c3e6cb}.no-activity-body[_ngcontent-%COMP%]{padding:.5rem 1rem}"]}),x)}],B=((Q=function e(){_classCallCheck(this,e)}).\u0275mod=M.Ob({type:Q}),Q.\u0275inj=M.Nb({factory:function(e){return new(e||Q)},imports:[[n.c,i.h.forChild(Y),a.f,r.j,u.a,a.j,s.a,c.a,l.a]]}),Q)},RPsU:function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var n=o("ofXK"),r=o("fXoL"),i=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e}()},oQl6:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o("1kSV"),r=o("pjmv"),i=o.n(r),a=o("fXoL"),s=function(){var e=function(e){_inherits(o,e);var t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"format",value:function(e){if(null==e)return"";var t=i()();return t.set("year",e.year),t.set("month",e.month-1),t.set("date",e.day),t.format("ddd, DD MMM, YYYY")}},{key:"parse",value:function(e){var t=i()(e,"ddd, DD MMM, YYYY");return{year:t.year(),month:t.month()+1,day:t.date()}}}]),o}(n.e);return e.\u0275fac=function(t){return c(t||e)},e.\u0275prov=a.Mb({token:e,factory:e.\u0275fac}),e}(),c=a.Yb(s)},tvVI:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var n=o("fXoL"),r=o("3Pt+"),i=o("ofXK"),a=function(e){return{hour:e,minute:0}};function s(e,t){if(1&e&&(n.Wb(0,"option",2),n.Qc(1),n.Vb()),2&e){var o=t.$implicit,r=n.kc();n.sc("ngValue",n.wc(2,a,o)),n.Cb(1),n.Sc(" ",r.addLeadingZeros(2,o),":00H ")}}function c(e,t){if(1&e&&(n.Wb(0,"option",2),n.Qc(1),n.Vb()),2&e){var o=n.kc();n.sc("ngValue",o.time),n.Cb(1),n.Tc("",o.addLeadingZeros(2,o.time.hour),":",o.addLeadingZeros(2,o.time.minute),"H")}}var u=function(){return{hour:23,minute:59}},l=function(){var e=function(){function e(){_classCallCheck(this,e),this.isDisabled=!1,this.time={hour:0,minute:0},this.timeChange=new n.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"triggerTimeChange",value:function(e){this.timeChange.emit(e)}},{key:"range",value:function(e,t){for(var o=[],n=e;n<t;n+=1)o.push(n);return o}},{key:"timeCompareFn",value:function(e,t){return e&&t&&e.hour===t.hour&&e.minute===t.minute}},{key:"isInFixedList",value:function(e){return e.hour>=1&&e.hour<=22&&0===e.minute||23===e.hour&&59===e.minute}},{key:"addLeadingZeros",value:function(e,t){return("0".repeat(e)+t).slice(-e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Kb({type:e,selectors:[["tm-time-picker"]],inputs:{isDisabled:"isDisabled",time:"time"},outputs:{timeChange:"timeChange"},decls:5,vars:7,consts:[[1,"form-control",3,"ngModel","disabled","compareWith","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"ngValue",4,"ngIf"]],template:function(e,t){1&e&&(n.Wb(0,"select",0),n.ic("ngModelChange",(function(e){return t.triggerTimeChange(e)})),n.Oc(1,s,2,4,"option",1),n.Wb(2,"option",2),n.Qc(3,"23:59H"),n.Vb(),n.Oc(4,c,2,3,"option",3),n.Vb()),2&e&&(n.sc("ngModel",t.time)("disabled",t.isDisabled)("compareWith",t.timeCompareFn),n.Cb(1),n.sc("ngForOf",t.range(1,24)),n.Cb(1),n.sc("ngValue",n.vc(6,u)),n.Cb(2),n.sc("ngIf",!t.isInFixedList(t.time)))},directives:[r.B,r.p,r.s,i.t,r.u,r.E,i.u],styles:[""]}),e}()},zAMY:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o("fXoL"),r=o("ofXK");function i(e,t){1&e&&n.Rb(0,"i",3)}function a(e,t){1&e&&n.Rb(0,"i",4)}var s=function(){var e=function(){function e(){_classCallCheck(this,e),this.isExpanded=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Kb({type:e,selectors:[["tm-panel-chevron"]],inputs:{isExpanded:"isExpanded"},decls:3,vars:2,consts:[[1,"chevron"],["class","fas fa-chevron-down",4,"ngIf"],["class","fas fa-chevron-up",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-up"]],template:function(e,t){1&e&&(n.Wb(0,"div",0),n.Oc(1,i,1,0,"i",1),n.Oc(2,a,1,0,"i",2),n.Vb()),2&e&&(n.Cb(1),n.sc("ngIf",!t.isExpanded),n.Cb(1),n.sc("ngIf",t.isExpanded))},directives:[r.u],styles:[".chevron[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}"]}),e}()}}]);