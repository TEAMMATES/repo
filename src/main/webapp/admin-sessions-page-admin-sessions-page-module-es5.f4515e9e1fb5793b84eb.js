function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{HnTE:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminSessionsPageModule",(function(){return z}));var i=n("ofXK"),s=n("3Pt+"),o=n("tyNb"),r=n("1kSV"),a=n("aSpy"),c=n("RPsU"),b=n("pjmv"),l=n.n(b),d=n("nYR2"),u=n("JUCI"),g=n("fXoL"),f=n("A3DQ"),h=n("Uqoa"),m=n("MbNv"),p=n("Lcal"),v=n("zAMY");function S(t,e){if(1&t&&(g.Wb(0,"option",32),g.Qc(1),g.Vb()),2&t){var n=e.$implicit;g.sc("value",n),g.Cb(1),g.Rc(n)}}function y(t,e){if(1&t){var n=g.Xb();g.Wb(0,"div",9),g.Wb(1,"div",10),g.Wb(2,"div",11),g.Wb(3,"div",12),g.Wb(4,"div",11),g.Wb(5,"div",13),g.Wb(6,"label",14),g.Qc(7,"From"),g.Vb(),g.Vb(),g.Vb(),g.Wb(8,"div",11),g.Wb(9,"div",13),g.Wb(10,"form"),g.Wb(11,"div",15),g.Wb(12,"div",16),g.Wb(13,"input",17,18),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc().startDate=t})),g.Vb(),g.Wb(15,"div",19),g.Wb(16,"button",20),g.ic("click",(function(){return g.Fc(n),g.Cc(14).toggle()})),g.Rb(17,"i",21),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Wb(18,"div",13),g.Wb(19,"ngb-timepicker",22),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc().startTime=t})),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Wb(20,"div",23),g.Wb(21,"div",11),g.Wb(22,"div",13),g.Wb(23,"label",14),g.Qc(24,"To"),g.Vb(),g.Vb(),g.Vb(),g.Wb(25,"div",11),g.Wb(26,"div",13),g.Wb(27,"form"),g.Wb(28,"div",15),g.Wb(29,"div",16),g.Wb(30,"input",24,25),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc().endDate=t})),g.Vb(),g.Wb(32,"div",19),g.Wb(33,"button",20),g.ic("click",(function(){return g.Fc(n),g.Cc(31).toggle()})),g.Rb(34,"i",21),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Wb(35,"div",13),g.Wb(36,"ngb-timepicker",22),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc().endTime=t})),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Wb(37,"div",26),g.Wb(38,"div",11),g.Wb(39,"div",27),g.Wb(40,"label",28),g.Qc(41,"Time Zone"),g.Vb(),g.Vb(),g.Vb(),g.Wb(42,"div",11),g.Wb(43,"div",13),g.Wb(44,"select",29),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc().filterTimezone=t})),g.Oc(45,S,2,2,"option",30),g.Vb(),g.Vb(),g.Wb(46,"div",13),g.Wb(47,"button",31),g.ic("click",(function(){return g.Fc(n),g.kc().getFeedbackSessions()})),g.Qc(48," Filter by Range "),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb()}if(2&t){var i=g.kc();g.Cb(13),g.sc("ngModel",i.startDate),g.Cb(6),g.sc("ngModel",i.startTime)("spinners",!1),g.Cb(11),g.sc("ngModel",i.endDate),g.Cb(6),g.sc("ngModel",i.endTime)("spinners",!1),g.Cb(8),g.sc("ngModel",i.filterTimezone),g.Cb(1),g.sc("ngForOf",i.timezones)}}function k(t,e){1&t&&(g.Wb(0,"div",33),g.Qc(1," Currently No Ongoing Sessions "),g.Vb())}function V(t,e){if(1&t&&(g.Wb(0,"option",32),g.Qc(1),g.Vb()),2&t){var n=e.$implicit;g.sc("value",n),g.Cb(1),g.Rc(n)}}function W(t,e){if(1&t&&(g.Wb(0,"span"),g.Qc(1),g.Vb()),2&t){var n=g.kc().$implicit;g.Cb(1),g.Rc(n.responseRate)}}function C(t,e){if(1&t){var n=g.Xb();g.Wb(0,"span"),g.Wb(1,"a",51),g.ic("click",(function(t){g.Fc(n);var e=g.kc().$implicit,i=g.kc(2).$implicit;return g.kc(3).getResponseRate(i.key,e.ongoingSession.courseId,e.ongoingSession.feedbackSessionName,t)})),g.Qc(2,"Show"),g.Vb(),g.Vb()}}function O(t,e){if(1&t&&(g.Wb(0,"tr"),g.Wb(1,"td"),g.Qc(2),g.Vb(),g.Wb(3,"td"),g.Wb(4,"strong"),g.Qc(5),g.Vb(),g.Qc(6),g.Vb(),g.Wb(7,"td"),g.Oc(8,W,2,1,"span",49),g.Oc(9,C,3,0,"span",49),g.Vb(),g.Wb(10,"td"),g.Qc(11),g.Vb(),g.Wb(12,"td"),g.Qc(13),g.Vb(),g.Wb(14,"td"),g.Wb(15,"a",50),g.Qc(16),g.Vb(),g.Vb(),g.Vb()),2&t){var n=e.$implicit;g.Cb(2),g.Rc(n.ongoingSession.sessionStatus),g.Cb(3),g.Sc("[",n.ongoingSession.courseId,"]"),g.Cb(1),g.Sc(" ",n.ongoingSession.feedbackSessionName,""),g.Cb(2),g.sc("ngIf",n.responseRate),g.Cb(1),g.sc("ngIf",!n.responseRate),g.Cb(2),g.Rc(n.startTimeString),g.Cb(2),g.Rc(n.endTimeString),g.Cb(2),g.sc("href",n.ongoingSession.instructorHomePageLink,g.Ic),g.Cb(1),g.Rc(n.ongoingSession.creatorEmail)}}function T(t,e){if(1&t&&(g.Wb(0,"div",45),g.Wb(1,"div",46),g.Wb(2,"table",47),g.Wb(3,"thead"),g.Wb(4,"tr"),g.Wb(5,"th"),g.Qc(6,"Status"),g.Vb(),g.Wb(7,"th"),g.Qc(8,"[Course ID] Session Name"),g.Vb(),g.Wb(9,"th"),g.Qc(10,"Response Rate"),g.Vb(),g.Wb(11,"th"),g.Qc(12,"Start Time"),g.Vb(),g.Wb(13,"th"),g.Qc(14,"End Time"),g.Vb(),g.Wb(15,"th"),g.Qc(16,"Creator"),g.Vb(),g.Vb(),g.Vb(),g.Wb(17,"tbody"),g.Oc(18,O,17,9,"tr",48),g.Vb(),g.Vb(),g.Vb(),g.Vb()),2&t){var n=g.kc().$implicit;g.sc("@collapseAnim",void 0),g.Cb(18),g.sc("ngForOf",n.value)}}function M(t,e){if(1&t){var n=g.Xb();g.Wb(0,"div",40),g.Wb(1,"div",41),g.ic("click",(function(){g.Fc(n);var t=e.$implicit,i=g.kc(3);return i.institutionPanelsStatus[t.key]=!i.institutionPanelsStatus[t.key]})),g.Wb(2,"strong"),g.Qc(3),g.Vb(),g.Wb(4,"div",42),g.Rb(5,"tm-panel-chevron",43),g.Vb(),g.Vb(),g.Oc(6,T,19,2,"div",44),g.Vb()}if(2&t){var i=e.$implicit,s=g.kc(3);g.Cb(3),g.Tc("",i.key," - Number of sessions: ",i.value.length,""),g.Cb(2),g.sc("isExpanded",s.institutionPanelsStatus[i.key]),g.Cb(1),g.sc("ngIf",s.institutionPanelsStatus[i.key])}}function w(t,e){if(1&t){var n=g.Xb();g.Wb(0,"div"),g.Wb(1,"div",35),g.Wb(2,"div",36),g.Qc(3," Display session start/end time in this time zone: "),g.Vb(),g.Wb(4,"div",37),g.Wb(5,"select",38),g.ic("ngModelChange",(function(t){return g.Fc(n),g.kc(2).tableTimezone=t}))("ngModelChange",(function(){return g.Fc(n),g.kc(2).updateDisplayedTimes()})),g.Oc(6,V,2,2,"option",30),g.Vb(),g.Vb(),g.Vb(),g.Oc(7,M,7,4,"div",39),g.lc(8,"keyvalue"),g.Vb()}if(2&t){var i=g.kc(2);g.Cb(5),g.sc("ngModel",i.tableTimezone),g.Cb(1),g.sc("ngForOf",i.timezones),g.Cb(1),g.sc("ngForOf",g.mc(8,3,i.sessions))}}function I(t,e){if(1&t&&(g.Wb(0,"div"),g.Oc(1,w,9,5,"div",34),g.Vb()),2&t){var n=g.kc(),i=g.Cc(20);g.Cb(1),g.sc("ngIf",n.totalOngoingSessions)("ngIfElse",i)}}var F,D,Q=[{path:"",component:(F=function(){function t(e,n,i){_classCallCheck(this,t),this.timezoneService=e,this.statusMessageService=n,this.feedbackSessionsService=i,this.totalOngoingSessions=0,this.totalOpenSessions=0,this.totalClosedSessions=0,this.totalAwaitingSessions=0,this.totalInstitutes=0,this.sessions={},this.institutionPanelsStatus={},this.showFilter=!1,this.timezones=[],this.filterTimezone="",this.tableTimezone="",this.startDate={},this.startTime={},this.endDate={},this.endTime={},this.timezoneString="",this.startTimeString="",this.endTimeString="",this.isLoadingOngoingSessions=!1}return _createClass(t,[{key:"ngOnInit",value:function(){this.timezones=Object.keys(this.timezoneService.getTzOffsets()),this.filterTimezone=this.timezoneService.guessTimezone(),this.tableTimezone=this.timezoneService.guessTimezone();var t=l()();this.startDate={year:t.year(),month:t.month()+1,day:t.date()},this.startTime={hour:t.hour(),minute:t.minute()},this.endTime={hour:t.hour(),minute:t.minute()};var e=l()(t).add(1,"weeks");this.endDate={year:e.year(),month:e.month()+1,day:e.date()},this.getFeedbackSessions()}},{key:"openAllInstitutions",value:function(){for(var t=0,e=Object.keys(this.institutionPanelsStatus);t<e.length;t++){var n=e[t];this.institutionPanelsStatus[n]=!0}}},{key:"closeAllInstitutions",value:function(){for(var t=0,e=Object.keys(this.institutionPanelsStatus);t<e.length;t++){var n=e[t];this.institutionPanelsStatus[n]=!1}}},{key:"showDateFromMillis",value:function(t){return this.timezoneService.formatToString(t,this.tableTimezone,"ddd, DD MMM YYYY, hh:mm a")}},{key:"getMomentInstant",value:function(t,e,n,i,s){var o=this.timezoneService.getMomentInstance(null,this.filterTimezone);return o.set("year",t),o.set("month",e),o.set("date",n),o.set("hour",i),o.set("minute",s),o}},{key:"getFeedbackSessions",value:function(){var t=this,e=this.getMomentInstant(this.startDate.year,this.startDate.month-1,this.startDate.day,this.startTime.hour,this.startTime.minute),n=this.getMomentInstant(this.endDate.year,this.endDate.month-1,this.endDate.day,this.endTime.hour,this.endTime.minute);this.startTimeString=e.format("ddd, DD MMM YYYY, hh:mm a"),this.endTimeString=n.format("ddd, DD MMM YYYY, hh:mm a"),this.timezoneString=this.filterTimezone,this.isLoadingOngoingSessions=!0,this.feedbackSessionsService.getOngoingSessions(e.toDate().getTime(),n.toDate().getTime()).pipe(Object(d.a)((function(){return t.isLoadingOngoingSessions=!1}))).subscribe((function(e){t.totalOngoingSessions=e.totalOngoingSessions,t.totalOpenSessions=e.totalOpenSessions,t.totalClosedSessions=e.totalClosedSessions,t.totalAwaitingSessions=e.totalAwaitingSessions,t.totalInstitutes=e.totalInstitutes,Object.keys(e.sessions).forEach((function(n){t.sessions[n]=e.sessions[n].map((function(e){return{ongoingSession:e,startTimeString:t.showDateFromMillis(e.startTime),endTimeString:t.showDateFromMillis(e.endTime)}}))})),t.institutionPanelsStatus={};for(var n=0,i=Object.keys(e.sessions);n<i.length;n++){var s=i[n];t.institutionPanelsStatus[s]=!0}}),(function(e){t.statusMessageService.showErrorToast(e.error.message)}))}},{key:"getResponseRate",value:function(t,e,n,i){var s=this;i&&(i.preventDefault(),i.stopPropagation()),this.feedbackSessionsService.loadSessionStatistics(e,n).subscribe((function(i){var o=s.sessions[t].filter((function(t){return t.ongoingSession.courseId===e&&t.ongoingSession.feedbackSessionName===n}));o.length&&(o[0].responseRate="".concat(i.submittedTotal," / ").concat(i.expectedTotal))}),(function(t){s.statusMessageService.showErrorToast(t.error.message)}))}},{key:"updateDisplayedTimes",value:function(){for(var t=0,e=Object.values(this.sessions);t<e.length;t++){var n,i=_createForOfIteratorHelper(e[t]);try{for(i.s();!(n=i.n()).done;){var s=n.value;s.startTimeString=this.showDateFromMillis(s.ongoingSession.startTime),s.endTimeString=this.showDateFromMillis(s.ongoingSession.endTime)}}catch(o){i.e(o)}finally{i.f()}}}}]),t}(),F.\u0275fac=function(t){return new(t||F)(g.Qb(f.b),g.Qb(h.a),g.Qb(m.a))},F.\u0275cmp=g.Kb({type:F,selectors:[["tm-admin-sessions-page"]],decls:22,vars:14,consts:[[1,"fas","fa-arrows-alt-h"],[1,"btn","btn-info","btn-sm","btn-margin-right",3,"click"],[1,"btn","btn-warning","btn-sm",3,"click"],[2,"margin-top","20px"],[1,"text-center"],["id","btn-toggle-filter",1,"btn","btn-link","center-block",3,"click"],["id","filter-section","class","card bg-light",4,"ngIf"],["noOngoingSessions",""],[4,"tmIsLoading"],["id","filter-section",1,"card","bg-light"],[1,"card-body"],[1,"row"],["data-toggle","tooltip","data-placement","top",1,"col-xl-4"],[1,"col-6"],[1,"label-control"],[1,"form-group"],[1,"input-group"],["id","start-date","placeholder","Date","name","dp1","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["dp1","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-light",3,"click"],[1,"fas","fa-calendar-alt"],[3,"ngModel","spinners","ngModelChange"],["data-toggle","tooltip","data-placement","top",1,"col-xl-4","border-left-gray"],["id","end-date","placeholder","Date","name","dp2","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["dp2","ngbDatepicker"],[1,"col-xl-4","border-left-gray"],[1,"col-12"],[1,"control-label"],["id","filter-timezone",1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","btn-get-sessions",1,"btn","btn-primary","btn-block",3,"click"],[3,"value"],["role","alert",1,"alert","alert-warning","margin-top-30px"],[4,"ngIf","ngIfElse"],[1,"row","margin-top-30px",2,"align-items","center"],[1,"col-md-5"],[1,"col-md-7"],["id","table-timezone",1,"form-control",3,"ngModel","ngModelChange"],["class","card bg-light margin-top-30px",4,"ngFor","ngForOf"],[1,"card","bg-light","margin-top-30px"],[1,"text-white","card-header","bg-primary","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],["class","card-body session-table-body",4,"ngIf"],[1,"card-body","session-table-body"],[1,"table-responsive"],["id","ongoing-sessions-table",1,"table","table-striped","data-table","session-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"href"],["href","javascript:;",3,"click"]],template:function(t,e){1&t&&(g.Wb(0,"h4"),g.Wb(1,"small"),g.Qc(2),g.Rb(3,"br"),g.Qc(4),g.Rb(5,"i",0),g.Qc(6),g.Vb(),g.Rb(7,"br"),g.Vb(),g.Wb(8,"button",1),g.ic("click",(function(){return e.openAllInstitutions()})),g.Qc(9,"Open All"),g.Vb(),g.Wb(10,"button",2),g.ic("click",(function(){return e.closeAllInstitutions()})),g.Qc(11,"Collapse All"),g.Vb(),g.Wb(12,"div",3),g.Wb(13,"div",4),g.Wb(14,"button",5),g.ic("click",(function(){return e.showFilter=!e.showFilter})),g.Qc(15),g.Rb(16,"br"),g.Rb(17,"i"),g.Vb(),g.Vb(),g.Oc(18,y,49,8,"div",6),g.Vb(),g.Oc(19,k,2,0,"ng-template",null,7,g.Pc),g.Oc(21,I,2,2,"div",8)),2&t&&(g.Cb(2),g.Vc(" Total: ",e.totalOngoingSessions," - Opened: ",e.totalOpenSessions," - Closed: ",e.totalClosedSessions," - Waiting To Open: ",e.totalAwaitingSessions," - Institutions: ",e.totalInstitutes," "),g.Cb(2),g.Sc(" ",e.startTimeString," \xa0 "),g.Cb(2),g.Tc(" \xa0 ",e.endTimeString," \xa0 ",e.timezoneString," "),g.Cb(9),g.Sc(" ",e.showFilter?"Hide":"Show"," filter "),g.Cb(2),g.Fb("fas fa-chevron-",e.showFilter?"up":"down",""),g.Cb(1),g.sc("ngIf",e.showFilter),g.Cb(3),g.sc("tmIsLoading",e.isLoadingOngoingSessions))},directives:[i.u,p.a,s.F,s.q,s.r,r.l,s.c,s.p,s.s,r.s,s.B,i.t,s.u,s.E,v.a],pipes:[i.m],styles:["@media (min-width:1200px){.border-left-gray[_ngcontent-%COMP%]{border-left:1px solid rgba(0,0,0,.2)}}.margin-top-30px[_ngcontent-%COMP%]{margin-top:30px}.session-table-body[_ngcontent-%COMP%]{padding:0}.session-table[_ngcontent-%COMP%]{margin-bottom:0}"],data:{animation:[u.a]}}),F)}],z=((D=function t(){_classCallCheck(this,t)}).\u0275mod=g.Ob({type:D}),D.\u0275inj=g.Nb({factory:function(t){return new(t||D)},imports:[[i.c,s.j,r.f,r.t,o.h.forChild(Q),a.a,c.a]]}),D)},JUCI:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("R0Ic"),s=Object(i.j)("collapseAnim",[Object(i.i)(":leave",[Object(i.h)({height:"*",overflow:"hidden"}),Object(i.e)("300ms ease-in-out",Object(i.h)({height:0,opacity:0}))]),Object(i.i)(":enter",[Object(i.h)({height:"0",overflow:"hidden"}),Object(i.e)("300ms ease-in-out",Object(i.h)({height:"*",opacity:1}))])])},RPsU:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("ofXK"),s=n("fXoL"),o=function(){var t=function t(){_classCallCheck(this,t)};return t.\u0275mod=s.Ob({type:t}),t.\u0275inj=s.Nb({factory:function(e){return new(e||t)},imports:[[i.c]]}),t}()},zAMY:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("fXoL"),s=n("ofXK");function o(t,e){1&t&&i.Rb(0,"i",3)}function r(t,e){1&t&&i.Rb(0,"i",4)}var a=function(){var t=function(){function t(){_classCallCheck(this,t),this.isExpanded=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Kb({type:t,selectors:[["tm-panel-chevron"]],inputs:{isExpanded:"isExpanded"},decls:3,vars:2,consts:[[1,"chevron"],["class","fas fa-chevron-down",4,"ngIf"],["class","fas fa-chevron-up",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-up"]],template:function(t,e){1&t&&(i.Wb(0,"div",0),i.Oc(1,o,1,0,"i",1),i.Oc(2,r,1,0,"i",2),i.Vb()),2&t&&(i.Cb(1),i.sc("ngIf",!e.isExpanded),i.Cb(1),i.sc("ngIf",e.isExpanded))},directives:[s.u],styles:[".chevron[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}"]}),t}()}}]);