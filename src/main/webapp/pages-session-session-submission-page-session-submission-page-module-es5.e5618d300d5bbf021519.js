function _createForOfIteratorHelper(e,t){var s;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(s=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){s&&(e=s);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){s=e[Symbol.iterator]()},n:function(){var e=s.next();return r=e.done,e},e:function(e){a=!0,o=e},f:function(){try{r||null==s.return||s.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"++8I":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("vMQM"),i=s("fXoL"),o=s("mW1j"),r=function(){var e=function(){function e(t){_classCallCheck(this,e),this.httpRequestService=t}return _createClass(e,[{key:"loadInstructors",value:function(e){var t={courseid:e.courseId};return e.intent&&(t.intent=e.intent),this.httpRequestService.get(n.d.INSTRUCTORS,t)}},{key:"getInstructor",value:function(e){var t={courseid:e.courseId,intent:e.intent};return e.feedbackSessionName&&(t.fsname=e.feedbackSessionName),e.key&&(t.key=e.key),e.moderatedPerson&&(t.moderatedperson=e.moderatedPerson),e.previewAs&&(t.previewas=e.previewAs),this.httpRequestService.get(n.d.INSTRUCTOR,t)}},{key:"createInstructor",value:function(e){return this.httpRequestService.post(n.d.INSTRUCTOR,{courseid:e.courseId},e.requestBody)}},{key:"updateInstructor",value:function(e){return this.httpRequestService.put(n.d.INSTRUCTOR,{courseid:e.courseId},e.requestBody)}},{key:"deleteInstructor",value:function(e){var t={courseid:e.courseId};return e.instructorEmail&&(t.instructoremail=e.instructorEmail),e.instructorId&&(t.instructorid=e.instructorId),this.httpRequestService.delete(n.d.INSTRUCTOR,t)}},{key:"loadInstructorPrivilege",value:function(e){var t={courseid:e.courseId};return e.feedbackSessionName&&(t.fsname=e.feedbackSessionName),e.sectionName&&(t.sectionname=e.sectionName),e.instructorRole&&(t.instructorrole=e.instructorRole),e.instructorEmail&&(t.instructoremail=e.instructorEmail),e.instructorId&&(t.instructorid=e.instructorId),this.httpRequestService.get(n.d.INSTRUCTOR_PRIVILEGE,t)}},{key:"updateInstructorPrivilege",value:function(e){return this.httpRequestService.put(n.d.INSTRUCTOR_PRIVILEGE,{courseid:e.courseId,instructoremail:e.instructorEmail},e.requestBody)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.ec(o.a))},e.\u0275prov=i.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Iab2:function(e,t,s){var n,i;void 0===(i="function"==typeof(n=function(){"use strict";function t(e,t,s){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){o(n.response,t,s)},n.onerror=function(){console.error("could not download file")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(s)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,o=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(e,o,r){var a=i.URL||i.webkitURL,c=document.createElement("a");c.download=o=o||e.name||"download",c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?n(c):s(c.href)?t(e,o,r):n(c,c.target="_blank")):(c.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(c.href)}),4e4),setTimeout((function(){n(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,i,o){if(i=i||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,o),i);else if(s(e))t(e,i,o);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){n(r)}))}}:function(e,s,n,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,s,n);var r="application/octet-stream"===e.type,a=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&a)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var d=i.URL||i.webkitURL,b=d.createObjectURL(e);o?o.location=b:location.href=b,o=null,setTimeout((function(){d.revokeObjectURL(b)}),4e4)}});i.saveAs=o.saveAs=o,e.exports=o})?n.apply(t,[]):n)||(e.exports=i)},QxDs:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("R8lv"),i=s("fXoL"),o=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t,s,i){switch(e){case n.g.RECIPIENT:var o="";switch(t){case n.c.INSTRUCTORS:o="instructor";break;case n.c.STUDENTS:case n.c.OWN_TEAM_MEMBERS:case n.c.OWN_TEAM_MEMBERS_INCLUDING_SELF:o="student";break;case n.c.TEAMS:case n.c.OWN_TEAM:o="team";break;default:return"unknown"}return[n.c.INSTRUCTORS,n.c.STUDENTS,n.c.TEAMS].includes(t)&&(s===n.m.UNLIMITED||s===n.m.CUSTOM&&void 0!==i&&i>1)&&(o+="s"),"The receiving "+o;case n.g.GIVER_TEAM_MEMBERS:return"Your team members";case n.g.INSTRUCTORS:return"Instructors in this course";case n.g.STUDENTS:return"Other students in the course";case n.g.RECIPIENT_TEAM_MEMBERS:return"The recipient's team members";default:return"Unknown"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Pb({name:"visibilityEntityName",type:e,pure:!0}),e}()},URxh:function(e,t,s){"use strict";s.r(t),s.d(t,"SessionSubmissionPageModule",(function(){return _e}));var n=s("ofXK"),i=s("3Pt+"),o=s("tyNb"),r=s("1kSV"),a=s("n6pr"),c=s("mYbV"),u=s("aSpy"),d=s("jd1o"),b=s("SEFB"),m=s("Iab2"),l=s("ayBD"),f=s("fXoL"),p=s("A3DQ");function h(e,t){1&e&&(f.Wb(0,"span"),f.Rb(1,"i",11),f.Qc(2," All responses submitted successfully! "),f.Vb())}function v(e,t){1&e&&(f.Wb(0,"span"),f.Rb(1,"i",12),f.Qc(2," Some questions were not saved! "),f.Vb())}function g(e,t){if(1&e&&(f.Wb(0,"p",13),f.Rb(1,"i",14),f.Qc(2),f.Vb()),2&e){var s=f.kc();f.Cb(2),f.Sc(" Note that some questions are yet to be answered. They are: ",s.notYetAnsweredQuestions.join(", "),". ")}}function S(e,t){if(1&e&&(f.Wb(0,"li"),f.Qc(1),f.Vb()),2&e){var s=t.$implicit;f.Cb(1),f.Tc(" Question ",s.key,": ",s.value," ")}}function k(e,t){if(1&e&&(f.Wb(0,"div",15),f.Rb(1,"i",14),f.Qc(2," Some answers to questions are not saved due to errors. "),f.Wb(3,"ul"),f.Oc(4,S,2,2,"li",16),f.lc(5,"keyvalue"),f.Vb(),f.Vb()),2&e){var s=f.kc();f.Cb(4),f.sc("ngForOf",f.mc(5,1,s.failToSaveQuestions))}}function y(e,t){1&e&&(f.Wb(0,"p"),f.Qc(1," All your responses have been successfully recorded! "),f.Vb())}var I,T=function(e,t){return{"bg-danger":e,"bg-success":t}},E=function(e,t){return{"btn-danger":e,"btn-success":t}},w=((I=function(){function e(t,s){_classCallCheck(this,e),this.activeModal=t,this.timezoneService=s,this.courseId="",this.feedbackSessionName="",this.feedbackSessionTimezone="",this.personEmail="",this.personName="",this.requestIds={},this.questions=[],this.answers={},this.notYetAnsweredQuestions=[],this.failToSaveQuestions={}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"downloadProofOfSubmission",value:function(){var e,t=(new Date).getTime(),s=["TEAMMATES Proof of Submission","".concat(t,"::").concat(this.timezoneService.formatToString(t,this.feedbackSessionTimezone,"YYYYMMDDHHmmSSZZ")),"==============================","Submitted by: ".concat(this.personName," [").concat(this.personEmail,"]"),"Course: "+this.courseId,"Session: "+this.feedbackSessionName,"","",""],n=_createForOfIteratorHelper(this.questions);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(this.requestIds[i.feedbackQuestionId]){if(s.push("".concat(i.questionNumber,": ").concat(i.questionBrief)),s.push(i.feedbackQuestionId),s.push(this.requestIds[i.feedbackQuestionId]),this.answers[i.feedbackQuestionId]){var o,r=_createForOfIteratorHelper(this.answers[i.feedbackQuestionId]);try{for(r.s();!(o=r.n()).done;){var a=o.value;s.push("> "+a.recipientIdentifier),s.push(l.a.fromApiOutput(a.responseDetails).getResponseCsvAnswers(i.questionDetails).join(","))}}catch(u){r.e(u)}finally{r.f()}}s.push(""),s.push("")}}}catch(u){n.e(u)}finally{n.f()}var c=new Blob([s.join("\r\n")],{type:"text/plain"});Object(m.saveAs)(c,"TEAMMATES Proof of Submission - "+t)}},{key:"hasFailToSaveQuestions",get:function(){return 0!==Object.keys(this.failToSaveQuestions).length}}]),e}()).\u0275fac=function(e){return new(e||I)(f.Qb(r.a),f.Qb(p.b))},I.\u0275cmp=f.Kb({type:I,selectors:[["tm-saving-complete-modal"]],inputs:{courseId:"courseId",feedbackSessionName:"feedbackSessionName",feedbackSessionTimezone:"feedbackSessionTimezone",personEmail:"personEmail",personName:"personName",requestIds:"requestIds",questions:"questions",answers:"answers",notYetAnsweredQuestions:"notYetAnsweredQuestions",failToSaveQuestions:"failToSaveQuestions"},decls:19,vars:13,consts:[[1,"modal-header","text-white",3,"ngClass"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"modal-body"],["id","not-answered-questions",4,"ngIf"],["class","text-danger","style","margin-bottom: 10px;",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-info",3,"click"],["type","button",1,"btn","modal-btn-ok",3,"ngClass","click"],[1,"fas","fa-check-circle"],[1,"fas","fa-exclamation-circle"],["id","not-answered-questions"],[1,"fas","fa-exclamation"],[1,"text-danger",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(f.Wb(0,"div",0),f.Wb(1,"h5",1),f.Oc(2,h,3,0,"span",2),f.Oc(3,v,3,0,"span",2),f.Vb(),f.Wb(4,"button",3),f.ic("click",(function(){return t.activeModal.dismiss()})),f.Rb(5,"i",4),f.Vb(),f.Vb(),f.Wb(6,"div",5),f.Oc(7,g,3,1,"p",6),f.Oc(8,k,6,3,"div",7),f.Oc(9,y,2,0,"p",2),f.Wb(10,"p"),f.Qc(11," Note that you can change your responses and submit them again any time before the session closes. "),f.Vb(),f.Wb(12,"p"),f.Qc(13," You are encouraged to download the proof of submission, which will also contain your latest responses. "),f.Vb(),f.Vb(),f.Wb(14,"div",8),f.Wb(15,"button",9),f.ic("click",(function(){return t.downloadProofOfSubmission()})),f.Qc(16,"Download proof of submission"),f.Vb(),f.Wb(17,"button",10),f.ic("click",(function(){return t.activeModal.close()})),f.Qc(18,"OK"),f.Vb(),f.Vb()),2&e&&(f.sc("ngClass",f.xc(7,T,t.hasFailToSaveQuestions,!t.hasFailToSaveQuestions)),f.Cb(2),f.sc("ngIf",!t.hasFailToSaveQuestions),f.Cb(1),f.sc("ngIf",t.hasFailToSaveQuestions),f.Cb(4),f.sc("ngIf",0!==t.notYetAnsweredQuestions.length),f.Cb(1),f.sc("ngIf",t.hasFailToSaveQuestions),f.Cb(1),f.sc("ngIf",!t.hasFailToSaveQuestions),f.Cb(8),f.sc("ngClass",f.xc(10,E,t.hasFailToSaveQuestions,!t.hasFailToSaveQuestions)))},directives:[n.r,n.u,n.t],pipes:[n.m],styles:[""]}),I),R=s("cp0P"),C=s("LRne"),F=s("vkgz"),Q=s("eIep"),M=s("nYR2"),O=s("JIr8"),N=s("dOUP"),W=s("vMQM"),V=s("R8lv"),q=s("9jjE"),A=s("UT40"),P=s("wuQz"),L=s("zHuJ"),U=s("/Tzu"),_=s("Uqoa"),D=s("YxrJ"),B=s("eoFM"),x=s("MbNv"),j=s("iRmZ"),G=s("++8I"),Y=s("eQqG"),z=s("Zgu1"),K=s("nAaM"),H=s("Pvcr"),X=s("r0mR"),Z=s("65rL");function J(e,t){1&e&&(f.Wb(0,"span"),f.Qc(1,"student"),f.Vb())}function $(e,t){1&e&&(f.Wb(0,"span"),f.Qc(1,"instructor"),f.Vb())}function ee(e,t){if(1&e){var s=f.Xb();f.Wb(0,"button",10),f.ic("click",(function(){return f.Fc(s),f.kc(2).isModerationHintExpanded=!0})),f.Qc(1,"[More]"),f.Vb()}}function te(e,t){if(1&e){var s=f.Xb();f.Wb(0,"button",10),f.ic("click",(function(){return f.Fc(s),f.kc(2).isModerationHintExpanded=!1})),f.Qc(1,"[Less]"),f.Vb()}}function se(e,t){if(1&e&&(f.Wb(0,"div",11),f.Wb(1,"p"),f.Qc(2),f.Vb(),f.Wb(3,"p"),f.Qc(4," Note that due to visibility settings, questions that are not supposed to show responses to instructors (i.e you) are not shown in the page below. "),f.Vb(),f.Vb()),2&e){var s=f.kc(2);f.Cb(2),f.Tc(" The page below resembles the submission page as seen by the respondent ",s.personName," (",s.moderatedPerson,"). You can use it to moderate responses submitted by the respondent or submit responses on behalf of the respondent. ")}}function ne(e,t){if(1&e&&(f.Wb(0,"div",5),f.Wb(1,"div",6),f.Wb(2,"h5"),f.Qc(3,"You are moderating responses for "),f.Oc(4,J,2,0,"span",7),f.Oc(5,$,2,0,"span",7),f.Qc(6),f.Oc(7,ee,2,0,"button",8),f.Oc(8,te,2,0,"button",8),f.Vb(),f.Oc(9,se,5,2,"div",9),f.Vb(),f.Vb()),2&e){var s=f.kc();f.Cb(4),f.sc("ngIf",s.intent===s.Intent.STUDENT_SUBMISSION),f.Cb(1),f.sc("ngIf",s.intent===s.Intent.INSTRUCTOR_SUBMISSION),f.Cb(1),f.Tc(" ",s.personName," (",s.moderatedPerson,") "),f.Cb(1),f.sc("ngIf",!s.isModerationHintExpanded),f.Cb(1),f.sc("ngIf",s.isModerationHintExpanded),f.Cb(1),f.sc("ngIf",s.isModerationHintExpanded)}}function ie(e,t){1&e&&(f.Wb(0,"span"),f.Qc(1,"student"),f.Vb())}function oe(e,t){1&e&&(f.Wb(0,"span"),f.Qc(1,"instructor"),f.Vb())}function re(e,t){if(1&e&&(f.Wb(0,"div",5),f.Wb(1,"div",6),f.Wb(2,"h4"),f.Qc(3,"Previewing Session as "),f.Oc(4,ie,2,0,"span",7),f.Oc(5,oe,2,0,"span",7),f.Qc(6),f.Vb(),f.Vb(),f.Vb()),2&e){var s=f.kc();f.Cb(4),f.sc("ngIf",s.intent===s.Intent.STUDENT_SUBMISSION),f.Cb(1),f.sc("ngIf",s.intent===s.Intent.INSTRUCTOR_SUBMISSION),f.Cb(1),f.Tc(" ",s.personName," (",s.previewAsPerson,") ")}}function ae(e,t){if(1&e){var s=f.Xb();f.Wb(0,"div"),f.Qc(1," You are submitting feedback as "),f.Wb(2,"mark"),f.Wb(3,"b"),f.Qc(4),f.Vb(),f.Vb(),f.Qc(5),f.Wb(6,"a",15),f.ic("click",(function(e){return f.Fc(s),f.kc(2).joinCourseForUnregisteredStudent(),e.preventDefault()})),f.Qc(7,"click here"),f.Vb(),f.Qc(8,". "),f.Vb()}if(2&e){var n=f.kc(2);f.Cb(4),f.Rc(n.personName),f.Cb(1),f.Sc(". If you wish to link your Google account (",n.loggedInUser,") with this user, ")}}function ce(e,t){if(1&e){var s=f.Xb();f.Wb(0,"div"),f.Qc(1," You are submitting feedback as "),f.Wb(2,"mark"),f.Wb(3,"b"),f.Qc(4),f.Vb(),f.Vb(),f.Qc(5,". You may submit feedback for sessions that are currently open and view results without logging in. To access other features you need to "),f.Wb(6,"a",15),f.ic("click",(function(e){return f.Fc(s),f.kc(2).joinCourseForUnregisteredStudent(),e.preventDefault()})),f.Qc(7,"login using a Google account"),f.Vb(),f.Qc(8," (optional). "),f.Vb()}if(2&e){var n=f.kc(2);f.Cb(4),f.Rc(n.personName)}}function ue(e,t){if(1&e&&(f.Wb(0,"div",12),f.Wb(1,"div",13),f.Wb(2,"div",14),f.Oc(3,ae,9,2,"div",7),f.Oc(4,ce,9,1,"div",7),f.Vb(),f.Vb(),f.Vb()),2&e){var s=f.kc();f.Cb(3),f.sc("ngIf",s.loggedInUser),f.Cb(1),f.sc("ngIf",!s.loggedInUser)}}function de(e,t){1&e&&(f.Wb(0,"div",12),f.Wb(1,"div",13),f.Wb(2,"div",14),f.Rb(3,"i",16),f.Qc(4," Note that you can use the Submit button to save responses already entered, and continue to answer remaining questions after that. You may also edit your submission any number of times before the closing time of this session. "),f.Vb(),f.Vb(),f.Vb())}function be(e,t){if(1&e&&(f.Wb(0,"div",17),f.Wb(1,"div",18),f.Rb(2,"br"),f.Wb(3,"div",19),f.Wb(4,"div",20),f.Wb(5,"b"),f.Qc(6,"Course ID:"),f.Vb(),f.Vb(),f.Wb(7,"div",21),f.Qc(8),f.Vb(),f.Vb(),f.Rb(9,"br"),f.Wb(10,"div",19),f.Wb(11,"div",20),f.Wb(12,"b"),f.Qc(13,"Session:"),f.Vb(),f.Vb(),f.Wb(14,"div",22),f.Qc(15),f.Vb(),f.Vb(),f.Rb(16,"br"),f.Wb(17,"div",19),f.Wb(18,"div",20),f.Wb(19,"b"),f.Qc(20,"Opening time:"),f.Vb(),f.Vb(),f.Wb(21,"div",23),f.Qc(22),f.Vb(),f.Vb(),f.Rb(23,"br"),f.Wb(24,"div",19),f.Wb(25,"div",20),f.Wb(26,"b"),f.Qc(27,"Closing time:"),f.Vb(),f.Vb(),f.Wb(28,"div",24),f.Qc(29),f.Vb(),f.Vb(),f.Rb(30,"br"),f.Wb(31,"div",19),f.Wb(32,"div",20),f.Wb(33,"b"),f.Qc(34,"Instructions:"),f.Vb(),f.Vb(),f.Rb(35,"div",25),f.lc(36,"safeHtml"),f.Vb(),f.Rb(37,"br"),f.Vb(),f.Vb()),2&e){var s=f.kc();f.Cb(8),f.Rc(s.courseId),f.Cb(7),f.Rc(s.feedbackSessionName),f.Cb(7),f.Rc(s.formattedSessionOpeningTime),f.Cb(7),f.Rc(s.formattedSessionClosingTime),f.Cb(6),f.sc("innerHTML",f.mc(36,5,s.feedbackSessionInstructions),f.Gc)}}function me(e,t){if(1&e){var s=f.Xb();f.Wb(0,"tm-question-submission-form",27),f.ic("formModelChange",(function(e){f.Fc(s);var n=t.index;return f.kc(2).questionSubmissionForms[n]=e}))("deleteCommentEvent",(function(e){f.Fc(s);var n=t.index;return f.kc(2).deleteParticipantComment(n,e)})),f.Vb()}if(2&e){var n=t.$implicit,i=t.index,o=f.kc(2);f.sc("formModel",o.questionSubmissionForms[i])("formMode",o.getQuestionSubmissionFormMode(n))("isDisabled",o.isSubmissionFormsDisabled&&!o.previewAsPerson),f.Db("id",n.feedbackQuestionId)}}function le(e,t){1&e&&(f.Wb(0,"div",12),f.Wb(1,"div",28),f.Wb(2,"div",29),f.Qc(3," There are no questions for you to answer here! "),f.Vb(),f.Vb(),f.Vb())}function fe(e,t){1&e&&f.Rb(0,"tm-ajax-loading")}function pe(e,t){if(1&e){var s=f.Xb();f.Wb(0,"div",12),f.Wb(1,"div",28),f.Wb(2,"button",30),f.ic("click",(function(){return f.Fc(s),f.kc(2).saveFeedbackResponses()})),f.Oc(3,fe,1,0,"tm-ajax-loading",7),f.Qc(4,"Submit Feedback"),f.Vb(),f.Vb(),f.Vb()}if(2&e){var n=f.kc(2);f.Cb(2),f.sc("disabled",n.isSavingResponses||n.isSubmissionFormsDisabled),f.Cb(1),f.sc("ngIf",n.isSavingResponses)}}function he(e,t){if(1&e&&(f.Wb(0,"div"),f.Oc(1,me,1,4,"tm-question-submission-form",26),f.Rb(2,"br"),f.Oc(3,le,4,0,"div",1),f.Oc(4,pe,5,2,"div",1),f.Vb()),2&e){var s=f.kc();f.Cb(1),f.sc("ngForOf",s.questionSubmissionForms)("ngForTrackBy",s.trackQuestionSubmissionFormByFn),f.Cb(2),f.sc("ngIf",!s.hasAnyResponseToSubmit),f.Cb(1),f.sc("ngIf",s.hasAnyResponseToSubmit)}}var ve,ge,Se=((ve=function(){function e(t,s,n,i,o,r,a,c,u,d,b,m,l,f,p,h,v){_classCallCheck(this,e),this.route=t,this.router=s,this.statusMessageService=n,this.timezoneService=i,this.feedbackQuestionsService=o,this.feedbackResponsesService=r,this.feedbackSessionsService=a,this.studentService=c,this.instructorService=u,this.ngbModal=d,this.simpleModalService=b,this.pageScrollService=m,this.authService=l,this.navigationService=f,this.commentService=p,this.logService=h,this.document=v,this.FeedbackSessionSubmissionStatus=V.f,this.Intent=q.b,this.courseId="",this.feedbackSessionName="",this.regKey="",this.loggedInUser="",this.moderatedPerson="",this.previewAsPerson="",this.personName="",this.personEmail="",this.formattedSessionOpeningTime="",this.formattedSessionClosingTime="",this.feedbackSessionInstructions="",this.feedbackSessionTimezone="",this.feedbackSessionSubmissionStatus=V.f.OPEN,this.intent=q.b.STUDENT_SUBMISSION,this.questionSubmissionForms=[],this.isSavingResponses=!1,this.isSubmissionFormsDisabled=!1,this.isModerationHintExpanded=!1,this.moderatedQuestionId="",this.isFeedbackSessionLoading=!0,this.isFeedbackSessionQuestionsLoading=!0,this.hasFeedbackSessionQuestionsLoadingFailed=!1,this.isFeedbackSessionQuestionResponsesLoading=!0,this.retryAttempts=A.a,this.backendUrl=N.a.backendUrl,this.timezoneService.getTzVersion()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.route.data.pipe(Object(F.a)((function(t){e.intent=t.intent})),Object(Q.a)((function(){return e.route.queryParams}))).subscribe((function(t){e.courseId=t.courseid,e.feedbackSessionName=t.fsname,e.regKey=t.key?t.key:"",e.moderatedPerson=t.moderatedperson?t.moderatedperson:"",e.previewAsPerson=t.previewas?t.previewas:"",e.moderatedQuestionId=t.moderatedquestionId?t.moderatedquestionId:"",e.previewAsPerson&&(e.isSubmissionFormsDisabled=!0);var s="".concat(window.location.pathname).concat(window.location.search);e.authService.getAuthUser(void 0,s).subscribe((function(t){var s=!(!t.user||!e.moderatedPerson&&!e.previewAsPerson);t.user&&(e.loggedInUser=t.user.id),e.regKey&&!s?e.authService.getAuthRegkeyValidity(e.regKey,e.intent).subscribe((function(s){s.isAllowedAccess?s.isUsed?e.navigationService.navigateByURLWithParamEncoding(e.router,"/web/student/sessions/submission",{courseid:e.courseId,fsname:e.feedbackSessionName}):(e.loadPersonName(),e.loadFeedbackSession()):s.isValid?e.loggedInUser?e.navigationService.navigateWithErrorMessage(e.router,"/web/front","You are not authorized to view this page."):window.location.href="".concat(e.backendUrl).concat(t.studentLoginUrl):e.navigationService.navigateWithErrorMessage(e.router,"/web/front","You are not authorized to view this page.")}),(function(){e.navigationService.navigateWithErrorMessage(e.router,"/web/front","You are not authorized to view this page.")})):e.loggedInUser?(e.loadPersonName(),e.loadFeedbackSession()):e.navigationService.navigateWithErrorMessage(e.router,"/web/front","You are not authorized to view this page.")}),(function(){e.navigationService.navigateWithErrorMessage(e.router,"/web/front","You are not authorized to view this page.")}))}))}},{key:"ngAfterViewInit",value:function(){var e=this;this.moderatedQuestionId&&setTimeout((function(){e.pageScrollService.scroll({document:e.document,scrollTarget:"#"+e.moderatedQuestionId,scrollOffset:70})}),500)}},{key:"loadPersonName",value:function(){var e=this;switch(this.intent){case q.b.STUDENT_SUBMISSION:this.studentService.getStudent(this.courseId,this.moderatedPerson||this.previewAsPerson,this.regKey).subscribe((function(t){e.personName=t.name,e.personEmail=t.email,e.logService.createFeedbackSessionLog({courseId:e.courseId,feedbackSessionName:e.feedbackSessionName,studentEmail:e.personEmail,logType:W.b.FEEDBACK_SESSION_ACCESS}).subscribe((function(){}),(function(){e.statusMessageService.showWarningToast("Failed to log feedback session access")}))}));break;case q.b.INSTRUCTOR_SUBMISSION:this.instructorService.getInstructor({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).subscribe((function(t){e.personName=t.name,e.personEmail=t.email}))}}},{key:"joinCourseForUnregisteredStudent",value:function(){this.navigationService.navigateByURL(this.router,"/web/join",{entitytype:"student",key:this.regKey})}},{key:"loadFeedbackSession",value:function(){var e=this;this.isFeedbackSessionLoading=!0,this.feedbackSessionsService.getFeedbackSession({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).pipe(Object(M.a)((function(){return e.isFeedbackSessionLoading=!1}))).subscribe((function(t){var s;if(e.feedbackSessionInstructions=t.instructions,e.formattedSessionOpeningTime=e.timezoneService.formatToString(t.submissionStartTimestamp,t.timeZone,"ddd, DD MMM, YYYY, hh:mm A zz"),e.formattedSessionClosingTime=e.timezoneService.formatToString(t.submissionEndTimestamp,t.timeZone,"ddd, DD MMM, YYYY, hh:mm A zz"),e.feedbackSessionSubmissionStatus=t.submissionStatus,e.feedbackSessionTimezone=t.timeZone,!e.moderatedPerson)switch(t.submissionStatus){case V.f.VISIBLE_NOT_OPEN:e.isSubmissionFormsDisabled=!0,s="<p><strong>The feedback session is currently not open for submissions.</strong></p>\n                <p>You can view the questions and any submitted responses\n                for this feedback session but cannot submit new responses.</p>",e.simpleModalService.openInformationModal("Feedback Session Not Open",U.a.WARNING,s);break;case V.f.OPEN:t.submissionEndTimestamp-Date.now()<9e5&&(s="Warning: you have less than 15 minutes before the submission deadline expires!",e.simpleModalService.openInformationModal("Feedback Session Will Be Closing Soon!",U.a.WARNING,s));break;case V.f.CLOSED:e.isSubmissionFormsDisabled=!0,s="<p><strong>Feedback Session is Closed</strong></p>\n                <p>You can view the questions and any submitted responses\n                for this feedback session but cannot submit new responses.</p>",e.simpleModalService.openInformationModal("Feedback Session Closed",U.a.WARNING,s)}e.loadFeedbackQuestions()}),(function(t){404===t.status&&(e.simpleModalService.openInformationModal("Feedback Session Does Not Exist!",U.a.DANGER,"The session does not exist (most likely deleted by the instructor after the submission link was sent)."),e.navigationService.navigateWithErrorMessage(e.router,"/web/student/home",t.error.message))}))}},{key:"loadFeedbackQuestions",value:function(){var e=this;this.isFeedbackSessionQuestionsLoading=!0,this.questionSubmissionForms=[],this.feedbackQuestionsService.getFeedbackQuestions({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).pipe(Object(M.a)((function(){return e.isFeedbackSessionQuestionsLoading=!1}))).subscribe((function(t){e.isFeedbackSessionQuestionResponsesLoading=0!==t.questions.length,t.questions.forEach((function(t){var s={feedbackQuestionId:t.feedbackQuestionId,questionNumber:t.questionNumber,questionBrief:t.questionBrief,questionDescription:t.questionDescription,giverType:t.giverType,recipientType:t.recipientType,recipientList:[],recipientSubmissionForms:[],questionType:t.questionType,questionDetails:t.questionDetails,numberOfEntitiesToGiveFeedbackToSetting:t.numberOfEntitiesToGiveFeedbackToSetting,customNumberOfEntitiesToGiveFeedbackTo:t.customNumberOfEntitiesToGiveFeedbackTo?t.customNumberOfEntitiesToGiveFeedbackTo:0,showGiverNameTo:t.showGiverNameTo,showRecipientNameTo:t.showRecipientNameTo,showResponsesTo:t.showResponsesTo};e.questionSubmissionForms.push(s),e.loadFeedbackQuestionRecipientsForQuestion(s)}))}),(function(t){e.handleError(t)}))}},{key:"trackQuestionSubmissionFormByFn",value:function(e,t){return t.feedbackQuestionId}},{key:"loadFeedbackQuestionRecipientsForQuestion",value:function(e){var t=this;this.feedbackQuestionsService.loadFeedbackQuestionRecipients({questionId:e.feedbackQuestionId,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).subscribe((function(s){if(s.recipients.forEach((function(t){e.recipientList.push({recipientIdentifier:t.identifier,recipientName:t.name})})),t.previewAsPerson){var n=t.getQuestionSubmissionFormMode(e);e.recipientList.forEach((function(s){if(!(n===L.a.FLEXIBLE_RECIPIENT&&e.recipientSubmissionForms.length>=e.customNumberOfEntitiesToGiveFeedbackTo)){var i="";n!==L.a.FLEXIBLE_RECIPIENT&&(i=s.recipientIdentifier),e.recipientSubmissionForms.push({recipientIdentifier:i,responseDetails:t.feedbackResponsesService.getDefaultFeedbackResponseDetails(e.questionType),responseId:"",isValid:!0})}})),t.isFeedbackSessionQuestionResponsesLoading=!1}else t.loadFeedbackResponses(e)}),(function(e){return t.statusMessageService.showErrorToast(e.error.message)}))}},{key:"getQuestionSubmissionFormMode",value:function(e){return(e.recipientType===V.c.STUDENTS||e.recipientType===V.c.TEAMS||e.recipientType===V.c.INSTRUCTORS)&&e.numberOfEntitiesToGiveFeedbackToSetting===V.m.CUSTOM&&e.recipientList.length>e.customNumberOfEntitiesToGiveFeedbackTo?L.a.FLEXIBLE_RECIPIENT:L.a.FIXED_RECIPIENT}},{key:"loadFeedbackResponses",value:function(e){var t=this;this.isFeedbackSessionQuestionResponsesLoading=!0,this.feedbackResponsesService.getFeedbackResponse({questionId:e.feedbackQuestionId,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson}).pipe(Object(M.a)((function(){return t.isFeedbackSessionQuestionResponsesLoading=!1}))).subscribe((function(s){if(t.getQuestionSubmissionFormMode(e)===L.a.FIXED_RECIPIENT&&e.recipientList.forEach((function(n){var i=s.responses.find((function(e){return e.recipientIdentifier===n.recipientIdentifier})),o={recipientIdentifier:n.recipientIdentifier,responseDetails:i?i.responseDetails:t.feedbackResponsesService.getDefaultFeedbackResponseDetails(e.questionType),responseId:i?i.feedbackResponseId:"",isValid:!0};i&&i.giverComment&&(o.commentByGiver=t.getCommentModel(i.giverComment)),e.recipientSubmissionForms.push(o)})),t.getQuestionSubmissionFormMode(e)===L.a.FLEXIBLE_RECIPIENT){var n=e.customNumberOfEntitiesToGiveFeedbackTo-s.responses.length;for(s.responses.forEach((function(t){e.recipientSubmissionForms.push({recipientIdentifier:t.recipientIdentifier,responseDetails:t.responseDetails,responseId:t.feedbackResponseId,isValid:!0})}));n>0;)e.recipientSubmissionForms.push({recipientIdentifier:"",responseDetails:t.feedbackResponsesService.getDefaultFeedbackResponseDetails(e.questionType),responseId:"",isValid:!0}),n-=1}}),(function(e){return t.statusMessageService.showErrorToast(e.error.message)}))}},{key:"getCommentModel",value:function(e){return{originalComment:e,commentEditFormModel:{commentText:e.commentText,isUsingCustomVisibilities:!1,showCommentTo:[],showGiverNameTo:[]},timezone:this.feedbackSessionTimezone,isEditing:!1}}},{key:"saveFeedbackResponses",value:function(){var e=this,t=new Set,s={},n={},i={},o=[];this.logService.createFeedbackSessionLog({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,studentEmail:this.personEmail,logType:W.b.FEEDBACK_SESSION_SUBMISSION}).subscribe((function(){}),(function(){e.statusMessageService.showWarningToast("Failed to log feedback session submission")})),this.questionSubmissionForms.forEach((function(r){var a=!0,c=[];r.recipientSubmissionForms.forEach((function(t){if(t.isValid){var s=e.feedbackResponsesService.isFeedbackResponseDetailsEmpty(r.questionType,t.responseDetails);a=a&&!s,s||c.push({recipient:t.recipientIdentifier,responseDetails:t.responseDetails})}else i[r.questionNumber]="Invalid responses provided. Please check question constraints."})),o.push(e.feedbackResponsesService.submitFeedbackResponses(r.feedbackQuestionId,{intent:e.intent,key:e.regKey,moderatedperson:e.moderatedPerson},{responses:c}).pipe(Object(F.a)((function(e){var t={};e.responses.forEach((function(e){t[e.recipientIdentifier]=e,n[r.feedbackQuestionId]=n[r.feedbackQuestionId]||[],n[r.feedbackQuestionId].push(e)})),s[r.feedbackQuestionId]=e.requestId||"",r.recipientSubmissionForms.forEach((function(e){if(t[e.recipientIdentifier]){var s=t[e.recipientIdentifier];e.responseId=s.feedbackResponseId,e.responseDetails=s.responseDetails,e.recipientIdentifier=s.recipientIdentifier}else e.responseId="",e.commentByGiver=void 0}))})),Object(Q.a)((function(){return Object(R.a)(r.recipientSubmissionForms.map((function(t){return e.createCommentRequest(t)})))})),Object(O.a)((function(e){return i[r.questionNumber]=e.error.message,Object(C.a)(e)})))),a||t.add(r.questionNumber)})),this.isSavingResponses=!0,Object(R.a)(o).pipe(Object(M.a)((function(){e.isSavingResponses=!1;var o=e.ngbModal.open(w);o.componentInstance.requestIds=s,o.componentInstance.courseId=e.courseId,o.componentInstance.feedbackSessionName=e.feedbackSessionName,o.componentInstance.feedbackSessionTimezone=e.feedbackSessionTimezone,o.componentInstance.personEmail=e.personEmail,o.componentInstance.personName=e.personName,o.componentInstance.questions=e.questionSubmissionForms,o.componentInstance.answers=n,o.componentInstance.notYetAnsweredQuestions=Array.from(t.values()),o.componentInstance.failToSaveQuestions=i}))).subscribe()}},{key:"createCommentRequest",value:function(e){var t=this;return e.responseId&&e.commentByGiver?e.commentByGiver.originalComment?""===e.commentByGiver.commentEditFormModel.commentText?this.commentService.deleteComment(e.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe(Object(F.a)((function(){e.commentByGiver=void 0}))):this.commentService.updateComment({commentText:e.commentByGiver.commentEditFormModel.commentText,showCommentTo:[],showGiverNameTo:[]},e.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe(Object(F.a)((function(s){e.commentByGiver=t.getCommentModel(s)}))):""===e.commentByGiver.commentEditFormModel.commentText?(e.commentByGiver=void 0,Object(C.a)({})):this.commentService.createComment({commentText:e.commentByGiver.commentEditFormModel.commentText,showCommentTo:[],showGiverNameTo:[]},e.responseId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe(Object(F.a)((function(s){e.commentByGiver=t.getCommentModel(s)}))):Object(C.a)({})}},{key:"deleteParticipantComment",value:function(e,t){var s=this,n=this.questionSubmissionForms[e].recipientSubmissionForms[t];n.commentByGiver&&n.commentByGiver.originalComment&&this.commentService.deleteComment(n.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).subscribe((function(){n.commentByGiver=void 0,s.statusMessageService.showSuccessToast("Your comment has been deleted!")}),(function(e){s.statusMessageService.showErrorToast(e.error.message)}))}},{key:"retryLoadingFeedbackSessionQuestions",value:function(){this.hasFeedbackSessionQuestionsLoadingFailed=!1,this.retryAttempts>=0&&(this.retryAttempts-=1),this.loadFeedbackQuestions()}},{key:"handleError",value:function(e){if(this.hasFeedbackSessionQuestionsLoadingFailed=!0,this.retryAttempts<0){var t=this.ngbModal.open(P.a);t.componentInstance.requestId=e.error.requestId,t.componentInstance.errorMessage=e.error.message}else this.statusMessageService.showErrorToast(e.error.message)}},{key:"hasAnyResponseToSubmit",get:function(){return this.questionSubmissionForms.some((function(e){return 0!==e.recipientSubmissionForms.length}))}}]),e}()).\u0275fac=function(e){return new(e||ve)(f.Qb(o.a),f.Qb(o.d),f.Qb(_.a),f.Qb(p.b),f.Qb(D.a),f.Qb(B.a),f.Qb(x.a),f.Qb(j.a),f.Qb(G.a),f.Qb(r.m),f.Qb(Y.a),f.Qb(z.b),f.Qb(K.a),f.Qb(H.a),f.Qb(X.a),f.Qb(Z.a),f.Qb(n.e))},ve.\u0275cmp=f.Kb({type:ve,selectors:[["tm-session-submission-page"]],decls:7,vars:8,consts:[["class","bg-light",4,"ngIf"],["class","row",4,"ngIf"],["class","card card-plain",4,"tmIsLoading"],[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],[1,"bg-light"],[1,"col-12","text-center","text-break"],[4,"ngIf"],["type","button","class","btn btn-link",3,"click",4,"ngIf"],["class","text-left",4,"ngIf"],["type","button",1,"btn","btn-link",3,"click"],[1,"text-left"],[1,"row"],[1,"col-12"],["role","alert",1,"alert","alert-primary"],["href","#",3,"click"],[1,"fas","fa-exclamation-circle"],[1,"card","card-plain"],[1,"card-body"],[1,"row","text-center"],[1,"col-md-3"],["id","course-id",1,"col-md-6"],["id","fs-name",1,"col-md-6"],["id","opening-time",1,"col-md-6"],["id","closing-time",1,"col-md-6"],["id","instructions",1,"col-md-6",3,"innerHTML"],[3,"formModel","formMode","isDisabled","formModelChange","deleteCommentEvent",4,"ngFor","ngForOf","ngForTrackBy"],[3,"formModel","formMode","isDisabled","formModelChange","deleteCommentEvent"],[1,"col-12","text-center"],["role","alert",1,"alert","alert-info"],["id","btn-submit","type","submit","ngbTooltip","You can save your responses at any time and come back later to continue.",1,"btn","btn-success",3,"disabled","click"]],template:function(e,t){1&e&&(f.Oc(0,ne,10,7,"div",0),f.Oc(1,re,7,4,"div",0),f.Oc(2,ue,5,2,"div",1),f.Oc(3,de,5,0,"div",1),f.Oc(4,be,38,7,"div",2),f.Wb(5,"tm-loading-retry",3),f.ic("retryEvent",(function(){return t.retryLoadingFeedbackSessionQuestions()})),f.Oc(6,he,5,4,"div",4),f.Vb()),2&e&&(f.sc("ngIf",t.moderatedPerson),f.Cb(1),f.sc("ngIf",t.previewAsPerson),f.Cb(1),f.sc("ngIf",t.regKey),f.Cb(1),f.sc("ngIf",t.feedbackSessionSubmissionStatus===t.FeedbackSessionSubmissionStatus.OPEN),f.Cb(1),f.sc("tmIsLoading",t.isFeedbackSessionLoading),f.Cb(1),f.sc("shouldShowRetry",t.hasFeedbackSessionQuestionsLoadingFailed)("message","Failed to load questions"),f.Cb(1),f.sc("tmIsLoading",t.isFeedbackSessionQuestionsLoading||t.isFeedbackSessionQuestionResponsesLoading))},styles:[".card-plain[_ngcontent-%COMP%]{background-color:#eaeff5;background-image:none;border:0;box-shadow:0 0 0 0}@media (min-width:768px){.col-md-3[_ngcontent-%COMP%]{text-align:right}.col-md-6[_ngcontent-%COMP%]{text-align:left}}"]}),ve),ke=s("Wsbs"),ye=s("ERjh"),Ie=s("yHMj"),Te=s("EBJT"),Ee=s("Lcal"),we=s("Babz"),Re=s("UGSt"),Ce=s("FYy5"),Fe=s("pTm8"),Qe=s("4mYk"),Me=s("WbH0"),Oe=s("OxLm"),Ne=s("Fw0q"),We=s("RMfs"),Ve=s("2SuZ"),qe=s("RNOZ"),Ae=s("WPPJ"),Pe=s("VKKU"),Le=s("ovlq"),Ue=[{path:"",component:Se}],_e=((ge=function e(){_classCallCheck(this,e)}).\u0275mod=f.Ob({type:ge}),ge.\u0275inj=f.Nb({factory:function(e){return new(e||ge)},imports:[[a.a,b.a,n.c,i.j,r.y,d.a,o.h.forChild(Ue),u.a,c.a]]}),ge);f.Jc(Se,[ke.a,ye.a,Ie.a,n.r,n.s,n.t,n.u,n.B,n.x,n.y,n.z,n.A,n.v,n.w,i.F,i.u,i.E,i.c,i.v,i.y,i.a,i.B,i.C,i.x,i.p,i.q,i.A,i.l,i.k,i.w,i.b,i.d,i.s,i.t,i.r,r.w,Te.a,o.i,o.e,o.g,o.f,o.k,Ee.a,we.a,w,Se],[Re.a,Ce.a,Fe.a,Qe.a,Me.a,Oe.a,Ne.a,We.a,Ve.a,qe.a,Ae.a,Pe.a,Le.a,n.b,n.I,n.q,n.l,n.F,n.g,n.D,n.G,n.d,n.f,n.j,n.k,n.m])},UT40:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var n=3},Wxyy:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("ofXK"),i=s("fXoL"),o=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=i.Ob({type:e}),e.\u0275inj=i.Nb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e}()},l12v:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("fXoL"),i=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e){var t="can see your response";return e.SHOW_RECIPIENT_NAME?(t+=", the name of the recipient",t+=e.SHOW_GIVER_NAME?", and your name":", but not your name"):t+=e.SHOW_GIVER_NAME?", and your name, but not the name of the recipient":", but not the name of the recipient, or your name",t}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Pb({name:"visibilityCapability",type:e,pure:!0}),e}()},wuQz:function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var n,i=s("dOUP"),o=s("fXoL"),r=s("vMQM"),a=s("mW1j"),c=((n=function(){function e(t){_classCallCheck(this,e),this.httpRequestService=t}return _createClass(e,[{key:"sendErrorReport",value:function(e){return this.httpRequestService.post(r.d.ERROR_REPORT,{},e.request)}}]),e}()).\u0275fac=function(e){return new(e||n)(o.ec(a.a))},n.\u0275prov=o.Mb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),u=s("1kSV"),d=s("Uqoa"),b=s("ofXK"),m=s("3Pt+");function l(e,t){1&e&&(o.Wb(0,"div"),o.Wb(1,"p"),o.Qc(2," We are sorry that this happened. Please help us troubleshoot the problem by providing us some additional details using the form below: "),o.Vb(),o.Vb())}function f(e,t){if(1&e&&(o.Wb(0,"div"),o.Wb(1,"p"),o.Qc(2," We are sorry that this happened. It is likely that your browser could not create or access cookies for authorization. If cookies are disabled in your browser, please turn on your cookies before trying again. Alternatively, you could also try emptying your browser's cache, or switching to a different browser. "),o.Vb(),o.Wb(3,"p"),o.Qc(4," For further support, please contact our email address at "),o.Wb(5,"a",6),o.Qc(6),o.Vb(),o.Qc(7,". "),o.Vb(),o.Vb()),2&e){var s=o.kc();o.Cb(5),o.uc("href","mailto:",s.supportEmail,"",o.Ic),o.Cb(1),o.Rc(s.supportEmail)}}function p(e,t){if(1&e){var s=o.Xb();o.Wb(0,"button",13),o.ic("click",(function(){return o.Fc(s),o.kc(2).sendErrorReport()})),o.Qc(1,"Send Error Report"),o.Vb()}if(2&e){var n=o.kc(2);o.sc("disabled",!n.sendButtonEnabled)}}function h(e,t){1&e&&(o.Wb(0,"div"),o.Qc(1," Your error report has been recorded. We will follow up with you in due course, usually, within 24 hours. "),o.Vb())}function v(e,t){if(1&e){var s=o.Xb();o.Wb(0,"div",7),o.Wb(1,"div",8),o.Wb(2,"label"),o.Qc(3,"Request ID:"),o.Vb(),o.Rb(4,"br"),o.Wb(5,"em"),o.Qc(6,"Note: This field is filled by the system and not modifiable."),o.Vb(),o.Wb(7,"input",9),o.ic("ngModelChange",(function(e){return o.Fc(s),o.kc().requestId=e})),o.Vb(),o.Vb(),o.Wb(8,"div",8),o.Wb(9,"label"),o.Qc(10,"Subject:"),o.Vb(),o.Rb(11,"br"),o.Wb(12,"em"),o.Qc(13,"Note: This field is pre-filled for convenience. Feel free to change it to suit your needs."),o.Vb(),o.Wb(14,"input",10),o.ic("ngModelChange",(function(e){return o.Fc(s),o.kc().subject=e})),o.Vb(),o.Vb(),o.Wb(15,"div",8),o.Wb(16,"label"),o.Qc(17,"Content:"),o.Vb(),o.Wb(18,"textarea",11),o.ic("ngModelChange",(function(e){return o.Fc(s),o.kc().content=e})),o.Vb(),o.Vb(),o.Oc(19,p,2,1,"button",12),o.Oc(20,h,2,0,"div",4),o.Vb()}if(2&e){var n=o.kc();o.Cb(7),o.sc("ngModel",n.requestId)("disabled",!0),o.Cb(7),o.sc("ngModel",n.subject),o.Cb(4),o.sc("ngModel",n.content),o.Cb(1),o.sc("ngIf",!n.errorReportSubmitted),o.Cb(1),o.sc("ngIf",n.errorReportSubmitted)}}var g,S=((g=function(){function e(t,s,n){_classCallCheck(this,e),this.errorReportService=t,this.ngbActiveModal=s,this.statusMessageService=n,this.errorMessage="",this.subject="User-submitted Error Report",this.content="",this.requestId="",this.sendButtonEnabled=!0,this.errorReportEnabled=!0,this.errorReportSubmitted=!1,this.csrfErrorMessages=["Missing CSRF token.","Invalid CSRF token."],this.supportEmail=i.a.supportEmail}return _createClass(e,[{key:"ngOnInit",value:function(){this.csrfErrorMessages.includes(this.errorMessage)&&(this.errorReportEnabled=!1)}},{key:"sendErrorReport",value:function(){var e=this,t={requestId:this.requestId,subject:this.subject,content:this.content};this.sendButtonEnabled=!1,this.errorReportService.sendErrorReport({request:t}).subscribe((function(){e.errorReportSubmitted=!0,e.statusMessageService.showSuccessToast("Your error report has been successfully sent"),e.ngbActiveModal.close()}),(function(t){e.sendButtonEnabled=!0,e.statusMessageService.showErrorToast(t.error.message)}))}}]),e}()).\u0275fac=function(e){return new(e||g)(o.Qb(c),o.Qb(u.a),o.Qb(d.a))},g.\u0275cmp=o.Kb({type:g,selectors:[["tm-error-report"]],decls:11,vars:4,consts:[[1,"container","error-container"],[1,"row"],[1,"col-md-12"],["id","error-message"],[4,"ngIf"],["id","error-report",4,"ngIf"],[3,"href"],["id","error-report"],[1,"form-group"],["type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Tell us the steps you took that led you to this error page",1,"form-control",3,"ngModel","ngModelChange"],["class","btn btn-success",3,"disabled","click",4,"ngIf"],[1,"btn","btn-success",3,"disabled","click"]],template:function(e,t){1&e&&(o.Wb(0,"div",0),o.Wb(1,"h2"),o.Qc(2,"Uh oh! Something went wrong."),o.Vb(),o.Rb(3,"hr"),o.Wb(4,"div",1),o.Wb(5,"div",2),o.Wb(6,"p",3),o.Qc(7),o.Vb(),o.Oc(8,l,3,0,"div",4),o.Oc(9,f,8,2,"div",4),o.Vb(),o.Vb(),o.Oc(10,v,21,6,"div",5),o.Vb()),2&e&&(o.Cb(7),o.Sc(' The server returns the following error message: "',t.errorMessage,'". '),o.Cb(1),o.sc("ngIf",t.errorReportEnabled),o.Cb(1),o.sc("ngIf",!t.errorReportEnabled),o.Cb(1),o.sc("ngIf",t.errorReportEnabled))},directives:[b.u,m.c,m.p,m.s],styles:[".error-container[_ngcontent-%COMP%]{padding:3%}"]}),g)}}]);